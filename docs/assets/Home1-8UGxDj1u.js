import{bS as sa,av as ra,r as S,c as la,w as na,o as ca,N as I,B as b,u as t,s,v as e,x as h,an as ta,y as x,ap as ea,p as c,q as f,X as j,V as y,A as ia,O as w,W as L}from"./index-DLkcM1tU.js";import{_ as ua}from"./music-Def25HgW.js";import{g as ga,u as da}from"./cover-DzIuO3oK.js";import{o as P}from"./overflowText--V61kkcr.js";import{T as ya}from"./v-scale-screen-b1uMIy6X.js";import{_ as pa}from"./plugin-vueexport-helper-DlAUqK2U.js";const va=["src"],ma={class:"basic-info"},_a={class:"info-box"},ha={key:0,class:"game-info"},fa={key:1},ka={class:"song"},Da={key:2},ba={class:"playing-container"},xa={class:"process-box"},Ca={class:"lyric-info"},Sa={key:0,class:"lyric-box"},Ia={class:"original"},wa={class:"translated"},La={key:1,class:"lyric-empty"},Pa={__name:"Home1",setup(Na){const a=sa(),m=ra(JSON.parse(localStorage.getItem("extraInfo"))),N=S(localStorage.getItem("backgroundColor")||"rgba(0, 0, 0, 0.8)"),p=S(localStorage.getItem("textColor")||"rgba(255, 255, 255, 1)"),z=S(localStorage.getItem("shadowColor")||"rgba(255, 255, 255, 1)"),k=S([]),B=la(()=>{var i,D;const n=((D=(i=a.songData)==null?void 0:i.player)==null?void 0:D.seekbarCurrentPositionHuman.split(":"))||0,l=parseInt(n[0])*60+parseInt(n[1]);let u=-1;for(let v=a.lyricData.lyric.length-1;v>=0;v--){const _=a.lyricData.lyric[v][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(_){const C=parseInt(_[1])*60+parseInt(_[2]);if(l>=C){u=v;break}}}let g=0;a.lyricData.translatedLyric.length===0?g=-(u-1)*73:g=-u*110;const d=document.querySelector(".lyric-box");return d&&(d.style.transform="translateY(".concat(g,"px)")),u}),oa=()=>{var u,g;const n=new da,l=new Image;l.src=ga((g=(u=a.songData)==null?void 0:u.track)==null?void 0:g.cover),l.onload=function(){const d=n.getColor(l);N.value="rgba(".concat(d.join(","),", 1)"),p.value="rgba(".concat(d.map(i=>255-i).join(","),", 1)"),z.value="rgba(".concat(d.map(i=>255-i).join(","),", 1)"),k.value=n.getPalette(l).map(i=>"rgba(".concat(i.join(","),", 1)"))}};return JSON.parse(localStorage.getItem("isCustomColor"))||na(()=>{var n,l;return(l=(n=a.songData)==null?void 0:n.track)==null?void 0:l.cover},(n,l)=>{n&&n!==l&&oa()}),ca(()=>{a.resetSongData()}),(n,l)=>(s(),I(t(ya),{width:1880,height:300,"box-style":{backgroundColor:"none"}},{default:b(()=>{var u,g,d,i,D,v,_,C,H,$,V,O,q,J,A,E,F,M,U,W,X,Y,G,K,Q,R;return[e("div",{class:"song-container",style:h({"--theme-color":N.value,"--text-color":p.value,"--bg-color":k.value[2]||p.value,"--shadow-color":z.value,"--stress-color":k.value[3]})},[ta(e("img",{id:"cover",class:x(["cover",{changing:t(a).isChanging}]),src:(g=(u=t(a).songData)==null?void 0:u.track)==null?void 0:g.cover,alt:"封面"},null,10,va),[[ea,(i=(d=t(a).songData)==null?void 0:d.track)==null?void 0:i.cover]]),ta(e("img",{class:x(["cover",{changing:t(a).isChanging}]),style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:ua,alt:""},null,2),[[ea,!((v=(D=t(a).songData)==null?void 0:D.track)!=null&&v.cover)]]),e("div",ma,[e("div",_a,[m.some(o=>o.length>0)?(s(),c("div",ha,[m[0].length>0?(s(),I(P,{key:0,"is-bold":"",color:p.value,"content-align":"center"},{default:b(()=>[j(y(m[0][0]),1)]),_:1},8,["color"])):f("",!0),m[1].length>0?(s(),c("div",fa,[ia(P,{color:p.value,"content-align":"space-around"},{default:b(()=>[(s(!0),c(w,null,L(m[1].join(" | ").split(" "),(o,r)=>(s(),c("span",{key:r},y(o),1))),128))]),_:1},8,["color"])])):f("",!0)])):f("",!0),e("div",{class:x(["song-info",{"song-info2":m.length===0}])},[e("div",ka,[(C=(_=t(a).songData)==null?void 0:_.track)!=null&&C.title?(s(),I(P,{key:0,color:p.value,"is-bold":"bold"},{default:b(()=>{var o,r;return[j(y((r=(o=t(a).songData)==null?void 0:o.track)==null?void 0:r.title),1)]}),_:1},8,["color"])):f("",!0),($=(H=t(a).songData)==null?void 0:H.track)!=null&&$.author?(s(),I(P,{key:1,color:p.value,"font-size":"35px"},{default:b(()=>{var o,r;return[j(y((r=(o=t(a).songData)==null?void 0:o.track)==null?void 0:r.author),1)]}),_:1},8,["color"])):f("",!0),!((O=(V=t(a).songData)==null?void 0:V.track)!=null&&O.title)&&!((J=(q=t(a).songData)==null?void 0:q.track)!=null&&J.author)?(s(),c("span",Da,"暂无歌曲信息")):f("",!0)]),e("div",ba,[e("div",{class:"sun",style:h({"animation-play-state":(E=(A=t(a).songData)==null?void 0:A.player)!=null&&E.isPaused?"paused":"running"})},[e("div",{class:"sun-body",style:h({"animation-play-state":(M=(F=t(a).songData)==null?void 0:F.player)!=null&&M.isPaused?"paused":"running"})},[(s(),c(w,null,L(8,o=>e("div",{class:"line",key:o,style:h({"--i":o})},null,4)),64))],4),e("div",{class:"eye",style:h({"animation-play-state":(W=(U=t(a).songData)==null?void 0:U.player)!=null&&W.isPaused?"paused":"running"})},null,4)],4),l[0]||(l[0]=e("div",{class:"horizon"},null,-1))])],2)]),e("div",xa,[e("span",null,y((Y=(X=t(a).songData)==null?void 0:X.player)==null?void 0:Y.seekbarCurrentPositionHuman),1),e("div",{class:"process-bar",style:h({"--bg-color":k.value[2]||N.value,"--stress-color":k.value[3]||p.value,"--process":((K=(G=t(a).songData)==null?void 0:G.player)==null?void 0:K.statePercent)||0})},null,4),e("span",null,y((R=(Q=t(a).songData)==null?void 0:Q.track)==null?void 0:R.durationHuman),1)])]),e("div",Ca,[t(a).lyricData.lyric.length>0?(s(),c("div",Sa,[t(a).lyricData.translatedLyric.length===0?(s(!0),c(w,{key:0},L(t(a).lyricData.lyric,(o,r)=>(s(),c("div",{class:x(["lyric-line",{active:r===B.value}]),key:r},[e("span",null,y(o[2]),1)],2))),128)):(s(!0),c(w,{key:1},L(t(a).lyricData.lyric,(o,r)=>{var Z,aa;return s(),c("div",{class:x(["lyric-line-translated",{active:r===B.value}]),key:r},[e("span",Ia,y((Z=t(a).lyricData.translatedLyric.find(T=>T[1]===t(a).lyricData.lyric[r][1]))!=null&&Z[2]?o[2]:""),1),e("span",wa,y(((aa=t(a).lyricData.translatedLyric.find(T=>T[1]===t(a).lyricData.lyric[r][1]))==null?void 0:aa[2])||o[2]),1)],2)}),128))])):(s(),c("div",La,"暂无歌词"))])],4)]}),_:1}))}},Va=pa(Pa,[["__scopeId","data-v-006c2fab"]]);export{Va as default};
