import{c3 as ca,aK as oa,a1 as I,X as ia,a3 as j,a2 as ua,as as w,at as C,L as t,am as l,ap as s,aA as f,aE as ra,aq as x,aF as la,al as c,an as k,bb as $,az as y,aH as da,ao as L,bd as P}from"./index-EYVoQ1Fb.js";import{_ as ga}from"./music-Def25HgW.js";import{g as ya,u as ma}from"./cover-DzIuO3oK.js";import{T as pa,o as T}from"./v-scale-screen-pqug9WN0.js";import{_ as va}from"./plugin-vueexport-helper-DlAUqK2U.js";const _a=["src"],ha={class:"basic-info"},fa={class:"info-box"},ka={key:0,class:"game-info"},Da={key:1},ba={class:"song"},Ca={key:2},xa={class:"playing-container"},Sa={class:"process-box"},Ia={class:"lyric-info"},wa={key:0,class:"lyric-box"},La={class:"original"},Pa={class:"translated"},Ta={key:1,class:"lyric-empty"},za={__name:"Home1",setup(Ha){const a=ca(),_=oa(JSON.parse(localStorage.getItem("extraInfo"))),z=I(localStorage.getItem("backgroundColor")||"rgba(0, 0, 0, 0.8)"),m=I(localStorage.getItem("textColor")||"rgba(255, 255, 255, 1)"),B=I(localStorage.getItem("shadowColor")||"rgba(255, 255, 255, 1)"),D=I([]),V=ia(()=>{var i,b;const e=((b=(i=a.songData)==null?void 0:i.player)==null?void 0:b.seekbarCurrentPositionHuman.split(":"))||0,o=parseInt(e[0])*60+parseInt(e[1]);let u=-1;for(let v=a.lyricData.lyric.length-1;v>=0;v--){const h=a.lyricData.lyric[v][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(h){const S=parseInt(h[1])*60+parseInt(h[2]);if(o>=S){u=v;break}}}let d=0;a.lyricData.translatedLyric.length===0?d=-(u-1)*73:d=-u*110;const g=document.querySelector(".lyric-box");return g&&(g.style.transform="translateY(".concat(d,"px)")),u}),na=()=>{var u,d;const e=new ma,o=new Image;o.src=ya((d=(u=a.songData)==null?void 0:u.track)==null?void 0:d.cover),o.onload=function(){const g=e.getColor(o);z.value="rgba(".concat(g.join(","),", 1)"),m.value="rgba(".concat(g.map(i=>255-i).join(","),", 1)"),B.value="rgba(".concat(g.map(i=>255-i).join(","),", 1)"),D.value=e.getPalette(o).map(i=>"rgba(".concat(i.join(","),", 1)"))}};JSON.parse(localStorage.getItem("isCustomColor"))||j(()=>{var e,o;return(o=(e=a.songData)==null?void 0:e.track)==null?void 0:o.cover},(e,o)=>{e&&e!==o&&na()});const p=oa({status:"已暂停",name:"暂无歌曲"}),H=()=>{p.status&&p.name?document.title=p.status+" - "+p.name:document.title="歌曲组件"};return j(()=>{var e,o;return(o=(e=a.songData)==null?void 0:e.player)==null?void 0:o.isPaused},e=>{e?p.status="已暂停":p.status="播放中",H()}),j(()=>{var e,o;return(o=(e=a.songData)==null?void 0:e.track)==null?void 0:o.title},e=>{p.name=e,H()}),ua(()=>{H(),a.resetSongData()}),(e,o)=>(l(),w(t(pa),{width:1880,height:300,"box-style":{backgroundColor:"none"}},{default:C(()=>{var u,d,g,i,b,v,h,S,q,E,F,J,O,A,K,M,U,X,Y,G,Q,R,W,Z,aa,ta;return[s("div",{class:"song-container",style:f({"--theme-color":z.value,"--text-color":m.value,"--bg-color":D.value[2]||m.value,"--shadow-color":B.value,"--stress-color":D.value[3]})},[ra(s("img",{id:"cover",class:x(["cover",{changing:t(a).isChanging}]),src:(d=(u=t(a).songData)==null?void 0:u.track)==null?void 0:d.cover,alt:"封面"},null,10,_a),[[la,(i=(g=t(a).songData)==null?void 0:g.track)==null?void 0:i.cover]]),ra(s("img",{class:x(["cover",{changing:t(a).isChanging}]),style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:ga,alt:""},null,2),[[la,!((v=(b=t(a).songData)==null?void 0:b.track)!=null&&v.cover)]]),s("div",ha,[s("div",fa,[_.some(r=>r.length>0)?(l(),c("div",ka,[_[0].length>0?(l(),w(T,{key:0,"is-bold":"",color:m.value,"content-align":"center"},{default:C(()=>[$(y(_[0][0]),1)]),_:1},8,["color"])):k("",!0),_[1].length>0?(l(),c("div",Da,[da(T,{color:m.value,"content-align":"space-around"},{default:C(()=>[(l(!0),c(L,null,P(_[1].join(" | ").split(" "),(r,n)=>(l(),c("span",{key:n},y(r),1))),128))]),_:1},8,["color"])])):k("",!0)])):k("",!0),s("div",{class:x(["song-info",{"song-info2":_.length===0}])},[s("div",ba,[(S=(h=t(a).songData)==null?void 0:h.track)!=null&&S.title?(l(),w(T,{key:0,color:m.value,"is-bold":"bold"},{default:C(()=>{var r,n;return[$(y((n=(r=t(a).songData)==null?void 0:r.track)==null?void 0:n.title),1)]}),_:1},8,["color"])):k("",!0),(E=(q=t(a).songData)==null?void 0:q.track)!=null&&E.author?(l(),w(T,{key:1,color:m.value,"font-size":"35px"},{default:C(()=>{var r,n;return[$(y((n=(r=t(a).songData)==null?void 0:r.track)==null?void 0:n.author),1)]}),_:1},8,["color"])):k("",!0),!((J=(F=t(a).songData)==null?void 0:F.track)!=null&&J.title)&&!((A=(O=t(a).songData)==null?void 0:O.track)!=null&&A.author)?(l(),c("span",Ca,"暂无歌曲信息")):k("",!0)]),s("div",xa,[s("div",{class:"sun",style:f({"animation-play-state":(M=(K=t(a).songData)==null?void 0:K.player)!=null&&M.isPaused?"paused":"running"})},[s("div",{class:"sun-body",style:f({"animation-play-state":(X=(U=t(a).songData)==null?void 0:U.player)!=null&&X.isPaused?"paused":"running"})},[(l(),c(L,null,P(8,r=>s("div",{class:"line",key:r,style:f({"--i":r})},null,4)),64))],4),s("div",{class:"eye",style:f({"animation-play-state":(G=(Y=t(a).songData)==null?void 0:Y.player)!=null&&G.isPaused?"paused":"running"})},null,4)],4),o[0]||(o[0]=s("div",{class:"horizon"},null,-1))])],2)]),s("div",Sa,[s("span",null,y((R=(Q=t(a).songData)==null?void 0:Q.player)==null?void 0:R.seekbarCurrentPositionHuman),1),s("div",{class:"process-bar",style:f({"--bg-color":D.value[2]||z.value,"--stress-color":D.value[3]||m.value,"--process":((Z=(W=t(a).songData)==null?void 0:W.player)==null?void 0:Z.statePercent)||0})},null,4),s("span",null,y((ta=(aa=t(a).songData)==null?void 0:aa.track)==null?void 0:ta.durationHuman),1)])]),s("div",Ia,[t(a).lyricData.lyric.length>0?(l(),c("div",wa,[t(a).lyricData.translatedLyric.length===0?(l(!0),c(L,{key:0},P(t(a).lyricData.lyric,(r,n)=>(l(),c("div",{class:x(["lyric-line",{active:n===V.value}]),key:n},[s("span",null,y(r[2]),1)],2))),128)):(l(!0),c(L,{key:1},P(t(a).lyricData.lyric,(r,n)=>{var ea,sa;return l(),c("div",{class:x(["lyric-line-translated",{active:n===V.value}]),key:n},[s("span",La,y((ea=t(a).lyricData.translatedLyric.find(N=>N[1]===t(a).lyricData.lyric[n][1]))!=null&&ea[2]?r[2]:""),1),s("span",Pa,y(((sa=t(a).lyricData.translatedLyric.find(N=>N[1]===t(a).lyricData.lyric[n][1]))==null?void 0:sa[2])||r[2]),1)],2)}),128))])):(l(),c("div",Ta,"暂无歌词"))])],4)]}),_:1}))}},qa=va(za,[["__scopeId","data-v-dd2d3645"]]);export{qa as default};
