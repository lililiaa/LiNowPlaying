import{bS as oa,av as sa,r as I,c as ra,w as la,o as na,N as w,B as f,u as t,s as r,v as o,x as h,an as Z,A as aa,aq as ca,p as n,ap as ta,q as k,X as z,V as y,O as L,W as P,y as B}from"./index-DUkU98TY.js";import{_ as ia}from"./music-Def25HgW.js";import{g as ua,u as da}from"./cover-DzIuO3oK.js";import{o as T}from"./overflowText-MHgtVsfW.js";import{T as ga}from"./v-scale-screen-C8hdMqua.js";import{_ as ya}from"./plugin-vueexport-helper-DlAUqK2U.js";const va=["src"],ma={class:"cover",style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:ia,alt:""},pa={class:"basic-info"},_a={class:"info-box"},fa={key:0,class:"game-info"},ha={key:1},ka={class:"song"},Da={key:2},ba={class:"playing-container"},xa={class:"process-box"},Ca={class:"lyric-info"},Sa={key:0,class:"lyric-box"},Ia={class:"original"},wa={class:"translated"},La={key:1,class:"lyric-empty"},Pa={__name:"Home1",setup(Ta){const a=oa(),p=sa(JSON.parse(localStorage.getItem("extraInfo"))),N=I(localStorage.getItem("backgroundColor")||"rgba(0, 0, 0, 0.8)"),v=I(localStorage.getItem("textColor")||"rgba(255, 255, 255, 1)"),H=I(localStorage.getItem("shadowColor")||"rgba(255, 255, 255, 1)"),D=I([]),$=ra(()=>{var i,b;const c=((b=(i=a.songData)==null?void 0:i.player)==null?void 0:b.seekbarCurrentPositionHuman.split(":"))||0,l=parseInt(c[0])*60+parseInt(c[1]);let u=-1;for(let m=a.lyricData.lyric.length-1;m>=0;m--){const _=a.lyricData.lyric[m][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(_){const S=parseInt(_[1])*60+parseInt(_[2]);if(l>=S){u=m;break}}}let d=0;a.lyricData.translatedLyric.length===0?d=-(u-1)*73:d=-u*110;const g=document.querySelector(".lyric-box");return g&&(g.style.transform="translateY(".concat(d,"px)")),u}),ea=()=>{var u,d;const c=new da,l=new Image;l.src=ua((d=(u=a.songData)==null?void 0:u.track)==null?void 0:d.cover),l.onload=function(){const g=c.getColor(l);N.value="rgba(".concat(g.join(","),", 1)"),v.value="rgba(".concat(g.map(i=>255-i).join(","),", 1)"),H.value="rgba(".concat(g.map(i=>255-i).join(","),", 1)"),D.value=c.getPalette(l).map(i=>"rgba(".concat(i.join(","),", 1)"))}};return JSON.parse(localStorage.getItem("isCustomColor"))||la(()=>{var c,l;return(l=(c=a.songData)==null?void 0:c.track)==null?void 0:l.cover},(c,l)=>{c&&c!==l&&ea()}),na(()=>{a.resetSongData()}),(c,l)=>(r(),w(t(ga),{width:1880,height:300,"box-style":{backgroundColor:"none"}},{default:f(()=>{var u,d,g,i,b,m,_,S,V,q,O,J,A,E,F,M,U,W,X,Y,G,K,Q,R;return[o("div",{class:"song-container",style:h({"--theme-color":N.value,"--text-color":v.value,"--bg-color":D.value[2]||v.value,"--shadow-color":H.value,"--stress-color":D.value[3]})},[Z(aa(ca,{name:"fade",mode:"out-in"},{default:f(()=>{var e,s,x,C;return[(r(),n("img",{id:"cover",class:"cover",key:(s=(e=t(a).songData)==null?void 0:e.track)==null?void 0:s.cover,src:(C=(x=t(a).songData)==null?void 0:x.track)==null?void 0:C.cover,alt:"封面"},null,8,va))]}),_:1},512),[[ta,(d=(u=t(a).songData)==null?void 0:u.track)==null?void 0:d.cover]]),Z(o("img",ma,null,512),[[ta,!((i=(g=t(a).songData)==null?void 0:g.track)!=null&&i.cover)]]),o("div",pa,[o("div",_a,[p.some(e=>e.length>0)?(r(),n("div",fa,[p[0].length>0?(r(),w(T,{key:0,"is-bold":"",color:v.value,"content-align":"center"},{default:f(()=>[z(y(p[0][0]),1)]),_:1},8,["color"])):k("",!0),p[1].length>0?(r(),n("div",ha,[aa(T,{color:v.value,"content-align":"space-around"},{default:f(()=>[(r(!0),n(L,null,P(p[1].join(" | ").split(" "),(e,s)=>(r(),n("span",{key:s},y(e),1))),128))]),_:1},8,["color"])])):k("",!0)])):k("",!0),o("div",{class:B(["song-info",{"song-info2":p.length===0}])},[o("div",ka,[(m=(b=t(a).songData)==null?void 0:b.track)!=null&&m.title?(r(),w(T,{key:0,color:v.value,"is-bold":"bold"},{default:f(()=>{var e,s;return[z(y((s=(e=t(a).songData)==null?void 0:e.track)==null?void 0:s.title),1)]}),_:1},8,["color"])):k("",!0),(S=(_=t(a).songData)==null?void 0:_.track)!=null&&S.author?(r(),w(T,{key:1,color:v.value,"font-size":"35px"},{default:f(()=>{var e,s;return[z(y((s=(e=t(a).songData)==null?void 0:e.track)==null?void 0:s.author),1)]}),_:1},8,["color"])):k("",!0),!((q=(V=t(a).songData)==null?void 0:V.track)!=null&&q.title)&&!((J=(O=t(a).songData)==null?void 0:O.track)!=null&&J.author)?(r(),n("span",Da,"暂无歌曲信息")):k("",!0)]),o("div",ba,[o("div",{class:"sun",style:h({"animation-play-state":(E=(A=t(a).songData)==null?void 0:A.player)!=null&&E.isPaused?"paused":"running"})},[o("div",{class:"sun-body",style:h({"animation-play-state":(M=(F=t(a).songData)==null?void 0:F.player)!=null&&M.isPaused?"paused":"running"})},[(r(),n(L,null,P(8,e=>o("div",{class:"line",key:e,style:h({"--i":e})},null,4)),64))],4),o("div",{class:"eye",style:h({"animation-play-state":(W=(U=t(a).songData)==null?void 0:U.player)!=null&&W.isPaused?"paused":"running"})},null,4)],4),l[0]||(l[0]=o("div",{class:"horizon"},null,-1))])],2)]),o("div",xa,[o("span",null,y((Y=(X=t(a).songData)==null?void 0:X.player)==null?void 0:Y.seekbarCurrentPositionHuman),1),o("div",{class:"process-bar",style:h({"--bg-color":D.value[2]||N.value,"--stress-color":D.value[3]||v.value,"--process":((K=(G=t(a).songData)==null?void 0:G.player)==null?void 0:K.statePercent)||0})},null,4),o("span",null,y((R=(Q=t(a).songData)==null?void 0:Q.track)==null?void 0:R.durationHuman),1)])]),o("div",Ca,[t(a).lyricData.lyric.length>0?(r(),n("div",Sa,[t(a).lyricData.translatedLyric.length===0?(r(!0),n(L,{key:0},P(t(a).lyricData.lyric,(e,s)=>(r(),n("div",{class:B(["lyric-line",{active:s===$.value}]),key:s},[o("span",null,y(e[2]),1)],2))),128)):(r(!0),n(L,{key:1},P(t(a).lyricData.lyric,(e,s)=>{var x,C;return r(),n("div",{class:B(["lyric-line-translated",{active:s===$.value}]),key:s},[o("span",Ia,y((x=t(a).lyricData.translatedLyric.find(j=>j[1]===t(a).lyricData.lyric[s][1]))!=null&&x[2]?e[2]:""),1),o("span",wa,y(((C=t(a).lyricData.translatedLyric.find(j=>j[1]===t(a).lyricData.lyric[s][1]))==null?void 0:C[2])||e[2]),1)],2)}),128))])):(r(),n("div",La,"暂无歌词"))])],4)]}),_:1}))}},Va=ya(Pa,[["__scopeId","data-v-b3c795d9"]]);export{Va as default};
