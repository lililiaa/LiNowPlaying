import{bS as dt,av as yt,r as I,c as mt,w as ht,o as vt,N as x,B as f,u as a,s as r,v as n,x as ct,an as it,y as w,ap as gt,p as l,q as h,A as _t,O as T,W as B,V as u,X as L}from"./index-DLkcM1tU.js";import{_ as pt}from"./music-Def25HgW.js";import{g as kt,u as ft}from"./cover-DzIuO3oK.js";import{o as C}from"./overflowText--V61kkcr.js";import{T as Dt}from"./v-scale-screen-b1uMIy6X.js";import{_ as bt}from"./plugin-vueexport-helper-DlAUqK2U.js";const xt=["src"],Ct={class:"basic-info"},St={key:0,class:"game-info"},It={key:0},wt={key:1,class:"song-info"},Tt={key:1},Lt={key:3},Nt={key:2,class:"song-info2"},zt={key:2},Bt={class:"process-box"},Ht={class:"lyric-info"},Pt={key:0,class:"lyric-box"},$t={class:"original"},jt={class:"translated"},Vt={key:1,class:"lyric-empty"},Ot={__name:"Home2",setup(qt){const t=dt(),v=yt(JSON.parse(localStorage.getItem("extraInfo")));let p=0;const H=()=>{let s=p;do s=(s+1)%v.length;while(v[s].length===0&&s!==p);v[s].length>0&&(p=s),setTimeout(H,8e3)},N=I(localStorage.getItem("backgroundColor")||"rgba(0, 0, 0, 0.8)"),d=I(localStorage.getItem("textColor")||"rgba(255, 255, 255, 1)"),P=I(localStorage.getItem("shadowColor")||"rgba(255, 255, 255, 1)"),D=I([]),$=mt(()=>{var i,b;const s=((b=(i=t.songData)==null?void 0:i.player)==null?void 0:b.seekbarCurrentPositionHuman.split(":"))||0,c=parseInt(s[0])*60+parseInt(s[1]);let g=-1;for(let _=t.lyricData.lyric.length-1;_>=0;_--){const k=t.lyricData.lyric[_][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(k){const S=parseInt(k[1])*60+parseInt(k[2]);if(c>=S){g=_;break}}}let y=0;t.lyricData.translatedLyric.length===0?y=-(g-1)*67:y=-g*100;const m=document.querySelector(".lyric-box");return m&&(m.style.transform="translateY(".concat(y,"px)")),g}),ut=()=>{var g,y;const s=new ft,c=new Image;c.src=kt((y=(g=t.songData)==null?void 0:g.track)==null?void 0:y.cover),c.onload=function(){const m=s.getColor(c);N.value="rgba(".concat(m.join(","),", 1)"),d.value="rgba(".concat(m.map(i=>255-i).join(","),", 1)"),P.value="rgba(".concat(m.map(i=>255-i).join(","),", 1)"),D.value=s.getPalette(c).map(i=>"rgba(".concat(i.join(","),", 1)"))}};return JSON.parse(localStorage.getItem("isCustomColor"))||ht(()=>{var s,c;return(c=(s=t.songData)==null?void 0:s.track)==null?void 0:c.cover},(s,c)=>{s&&s!==c&&ut()}),vt(()=>{t.resetSongData(),H()}),(s,c)=>(r(),x(a(Dt),{width:1880,height:280,"box-style":{backgroundColor:"none"}},{default:f(()=>{var g,y,m,i,b,_,k,S,j,V,O,q,E,J,A,F,M,U,W,X,Y,G,K,Q,R,Z,tt,at,et,ot,rt,st;return[n("div",{class:"song-container",style:ct({"--theme-color":N.value,"--text-color":d.value,"--bg-color":D.value[2]||d.value,"--shadow-color":P.value,"--stress-color":D.value[3]})},[it(n("img",{id:"cover",class:w(["cover",{changing:a(t).isChanging}]),src:(y=(g=a(t).songData)==null?void 0:g.track)==null?void 0:y.cover,alt:"封面"},null,10,xt),[[gt,(i=(m=a(t).songData)==null?void 0:m.track)==null?void 0:i.cover]]),it(n("img",{class:w(["cover",{changing:a(t).isChanging}]),style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:pt,alt:""},null,2),[[gt,!((_=(b=a(t).songData)==null?void 0:b.track)!=null&&_.cover)]]),n("div",Ct,[v.some(e=>e.length>0)?(r(),l("div",St,[(r(),l("div",{key:a(p)},[_t(C,{color:d.value,"is-bold":"bold","content-align":"space-evenly"},{default:f(()=>[(r(!0),l(T,null,B(v[a(p)],(e,o)=>(r(),l(T,null,[n("span",null,u(e),1),o<v[a(p)].length-1?(r(),l("span",It,"|")):h("",!0)],64))),256))]),_:1},8,["color"])]))])):h("",!0),v.some(e=>e.length!==0)?(r(),l("div",wt,[(S=(k=a(t).songData)==null?void 0:k.track)!=null&&S.title?(r(),x(C,{key:0,color:d.value,"is-bold":"bold"},{default:f(()=>{var e,o;return[L(u((o=(e=a(t).songData)==null?void 0:e.track)==null?void 0:o.title),1)]}),_:1},8,["color"])):h("",!0),(V=(j=a(t).songData)==null?void 0:j.track)!=null&&V.title&&((q=(O=a(t).songData)==null?void 0:O.track)!=null&&q.author)?(r(),l("span",Tt,"-")):h("",!0),(J=(E=a(t).songData)==null?void 0:E.track)!=null&&J.author?(r(),x(C,{key:2,color:d.value,"font-size":"35px"},{default:f(()=>{var e,o;return[L(u((o=(e=a(t).songData)==null?void 0:e.track)==null?void 0:o.author),1)]}),_:1},8,["color"])):h("",!0),!((F=(A=a(t).songData)==null?void 0:A.track)!=null&&F.title)&&!((U=(M=a(t).songData)==null?void 0:M.track)!=null&&U.author)?(r(),l("span",Lt,"暂无歌曲信息")):h("",!0)])):(r(),l("div",Nt,[(X=(W=a(t).songData)==null?void 0:W.track)!=null&&X.title?(r(),x(C,{key:0,color:d.value,"is-bold":"bold"},{default:f(()=>{var e,o;return[L(u((o=(e=a(t).songData)==null?void 0:e.track)==null?void 0:o.title),1)]}),_:1},8,["color"])):h("",!0),(G=(Y=a(t).songData)==null?void 0:Y.track)!=null&&G.author?(r(),x(C,{key:1,color:d.value,"font-size":"35px"},{default:f(()=>{var e,o;return[L(u((o=(e=a(t).songData)==null?void 0:e.track)==null?void 0:o.author),1)]}),_:1},8,["color"])):h("",!0),!((Q=(K=a(t).songData)==null?void 0:K.track)!=null&&Q.title)&&!((Z=(R=a(t).songData)==null?void 0:R.track)!=null&&Z.author)?(r(),l("span",zt,"暂无歌曲信息")):h("",!0)])),n("div",Bt,[n("span",null,u((at=(tt=a(t).songData)==null?void 0:tt.player)==null?void 0:at.seekbarCurrentPositionHuman),1),n("div",{class:"process-bar",style:ct({"--bg-color":D.value[2]||N.value,"--stress-color":D.value[3]||d.value,"--process":((ot=(et=a(t).songData)==null?void 0:et.player)==null?void 0:ot.statePercent)||0})},null,4),n("span",null,u((st=(rt=a(t).songData)==null?void 0:rt.track)==null?void 0:st.durationHuman),1)])]),n("div",Ht,[a(t).lyricData.lyric.length>0?(r(),l("div",Pt,[a(t).lyricData.translatedLyric.length===0?(r(!0),l(T,{key:0},B(a(t).lyricData.lyric,(e,o)=>(r(),l("div",{class:w(["lyric-line",{active:o===$.value}]),key:o},[n("span",null,u(e[2]),1)],2))),128)):(r(!0),l(T,{key:1},B(a(t).lyricData.lyric,(e,o)=>{var lt,nt;return r(),l("div",{class:w(["lyric-line-translated",{active:o===$.value}]),key:o},[n("span",$t,u((lt=a(t).lyricData.translatedLyric.find(z=>z[1]===a(t).lyricData.lyric[o][1]))!=null&&lt[2]?e[2]:""),1),n("span",jt,u(((nt=a(t).lyricData.translatedLyric.find(z=>z[1]===a(t).lyricData.lyric[o][1]))==null?void 0:nt[2])||e[2]),1)],2)}),128))])):(r(),l("div",Vt,"暂无歌词"))])],4)]}),_:1}))}},Wt=bt(Ot,[["__scopeId","data-v-956b6e97"]]);export{Wt as default};
