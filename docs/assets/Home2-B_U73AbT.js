import{b2 as U,aC as P,B as T,v as Y,D as I,C as q,a0 as _,a1 as h,u as a,U as o,Y as l,a8 as z,ad as H,Z as D,au as $,T as n,W as u,ah as F,X as b,a$ as w,a7 as i,aQ as x}from"./index-DmahVH0F.js";import{_ as J,a as M}from"./plugin-vueexport-helper-DwRewS5w.js";import{u as O}from"./color-thief-DF3QbzqH.js";import{T as Q,g as j,o as p}from"./cover-D5f8vDW1.js";const W=["src"],X={class:"basic-info"},Z={key:0,class:"game-info"},A={key:0},G={key:1,class:"song-info"},K={key:2},R={key:2,class:"song-info2"},tt={key:2},at={class:"process-box"},et={class:"lyric-info"},ot={key:0,class:"lyric-box"},st={class:"original"},rt={class:"translated"},nt={key:1,class:"lyric-empty"},lt={class:"lyric-bg"},ct=["src"],it={__name:"Home2",setup(ut){const t=U(),g=P(JSON.parse(localStorage.getItem("extraInfo")));let m=0;const L=()=>{let e=m;do e=(e+1)%g.length;while(g[e].length===0&&e!==m);g[e].length>0&&(m=e),setTimeout(L,8e3)},B=T("rgba(0, 0, 0, 0.8)"),d=T("rgba(255, 255, 255, 1)"),v=T([]),N=Y(()=>{const e=t.songData?.player?.seekbarCurrentPositionHuman.split(":")||0,c=parseInt(e[0])*60+parseInt(e[1]);let s=-1;for(let f=t.lyricData.lyric.length-1;f>=0;f--){const S=t.lyricData.lyric[f][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(S){const V=parseInt(S[1])*60+parseInt(S[2]);if(c>=V){s=f;break}}}let r=0;t.lyricData.translatedLyric.length===0?r=-(s-1)*67:r=-s*100;const k=document.querySelector(".lyric-box");return k&&(k.style.transform=`translateY(${r}px)`),s}),E=()=>{const e=new O,c=document.getElementsByClassName("cover")[0];c.onload=function(){const s=e.getColor(c);B.value=`rgba(${s.join(",")}, 1)`,d.value=`rgba(${s.map(r=>255-r).join(",")}, 1)`,v.value=e.getPalette(c).map(r=>`rgba(${r.join(",")}, 1)`)}};I(()=>t.songData?.track?.cover,(e,c)=>{e&&e!==c&&E()});const y=P({status:"已暂停",name:"暂无歌曲"}),C=()=>{y.status&&y.name?document.title=y.status+" - "+y.name:document.title="歌曲组件"};return I(()=>t.songData?.player?.isPaused,e=>{e?y.status="已暂停":y.status="播放中",C()}),I(()=>t.songData?.track?.title,e=>{y.name=e,C()}),q(()=>{C(),t.resetSongData(),L()}),(e,c)=>(o(),_(a(Q),{width:"1880",height:"280","box-style":{backgroundColor:e.none}},{default:h(()=>[l("div",{class:"song-container",style:z({"--theme-color":B.value,"--text-color":d.value,"--bg-color":v.value[2],"--stress-color":v.value[3]})},[H(l("img",{id:"cover",class:D(["cover",{changing:a(t).isChanging}]),crossorigin:"anonymous",src:a(j)(a(t).songData?.track?.cover),alt:"封面"},null,10,W),[[$,a(t).songData?.track?.cover]]),H(l("img",{class:D(["cover",{changing:a(t).isChanging}]),style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:M,alt:""},null,2),[[$,!a(t).songData?.track?.cover]]),l("div",X,[g.some(s=>s.length>0)?(o(),n("div",Z,[(o(),n("div",{key:a(m)},[F(p,{color:d.value,"is-bold":"bold","content-align":"space-evenly"},{default:h(()=>[(o(!0),n(b,null,w(g[a(m)],(s,r)=>(o(),n(b,null,[l("span",null,i(s),1),r<g[a(m)].length-1?(o(),n("span",A,"|")):u("",!0)],64))),256))]),_:1},8,["color"])]))])):u("",!0),g.some(s=>s.length!==0)?(o(),n("div",G,[a(t).songData?.track?.title?(o(),_(p,{key:0,color:d.value,"is-bold":"bold"},{default:h(()=>[x(i(a(t).songData?.track?.title),1)]),_:1},8,["color"])):u("",!0),c[0]||(c[0]=l("span",null,"-",-1)),a(t).songData?.track?.author?(o(),_(p,{key:1,color:d.value,"font-size":"35px"},{default:h(()=>[x(i(a(t).songData?.track?.author),1)]),_:1},8,["color"])):u("",!0),!a(t).songData?.track?.title&&!a(t).songData?.track?.author?(o(),n("span",K,"暂无歌曲信息")):u("",!0)])):(o(),n("div",R,[a(t).songData?.track?.title?(o(),_(p,{key:0,color:d.value,"is-bold":"bold"},{default:h(()=>[x(i(a(t).songData?.track?.title),1)]),_:1},8,["color"])):u("",!0),a(t).songData?.track?.author?(o(),_(p,{key:1,color:d.value,"font-size":"35px"},{default:h(()=>[x(i(a(t).songData?.track?.author),1)]),_:1},8,["color"])):u("",!0),!a(t).songData?.track?.title&&!a(t).songData?.track?.author?(o(),n("span",tt,"暂无歌曲信息")):u("",!0)])),l("div",at,[l("span",null,i(a(t).songData?.player?.seekbarCurrentPositionHuman),1),l("div",{class:"process-bar",style:z({"--bg-color":v.value[2],"--stress-color":v.value[3],"--process":a(t).songData?.player?.statePercent||0})},null,4),l("span",null,i(a(t).songData?.track?.durationHuman),1)])]),l("div",et,[a(t).lyricData.lyric.length>0?(o(),n("div",ot,[a(t).lyricData.translatedLyric.length===0?(o(!0),n(b,{key:0},w(a(t).lyricData.lyric,(s,r)=>(o(),n("div",{class:D(["lyric-line",{active:r===N.value}]),key:r},[l("span",null,i(s[2]),1)],2))),128)):(o(!0),n(b,{key:1},w(a(t).lyricData.lyric,(s,r)=>(o(),n("div",{class:D(["lyric-line-translated",{active:r===N.value}]),key:r},[l("span",st,i(s[2]),1),l("span",rt,i(a(t).lyricData.translatedLyric.find(k=>k[1]===a(t).lyricData.lyric[r][1])?.[2]||""),1)],2))),128))])):(o(),n("div",nt,"暂无歌词")),l("div",lt,[(o(),n("img",{crossorigin:"anonymous",key:a(t).songData?.track?.cover,src:a(j)(a(t).songData?.track?.cover),alt:""},null,8,ct))])])],4)]),_:1},8,["box-style"]))}},ht=J(it,[["__scopeId","data-v-f2f38ee5"]]);export{ht as default};
