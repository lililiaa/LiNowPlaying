import{bS as dt,av as gt,r as T,c as yt,w as mt,o as _t,N as S,B as p,u as a,s as r,v as n,x as st,an as lt,A as ct,aq as vt,p as l,ap as nt,q as _,O as L,W as H,V as d,X as N,y as it}from"./index-DUkU98TY.js";import{_ as ht}from"./music-Def25HgW.js";import{g as pt,u as kt}from"./cover-DzIuO3oK.js";import{o as I}from"./overflowText-MHgtVsfW.js";import{T as ft}from"./v-scale-screen-C8hdMqua.js";import{_ as Dt}from"./plugin-vueexport-helper-DlAUqK2U.js";const bt=["src"],xt={class:"cover",style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:ht,alt:""},Ct={class:"basic-info"},St={key:0,class:"game-info"},It={key:0},wt={key:1,class:"song-info"},Tt={key:1},Lt={key:3},Nt={key:2,class:"song-info2"},zt={key:2},Bt={class:"process-box"},Ht={class:"lyric-info"},Pt={key:0,class:"lyric-box"},$t={class:"original"},jt={class:"translated"},Vt={key:1,class:"lyric-empty"},qt={__name:"Home2",setup(Ot){const t=dt(),v=gt(JSON.parse(localStorage.getItem("extraInfo")));let k=0;const P=()=>{let s=k;do s=(s+1)%v.length;while(v[s].length===0&&s!==k);v[s].length>0&&(k=s),setTimeout(P,8e3)},z=T(localStorage.getItem("backgroundColor")||"rgba(0, 0, 0, 0.8)"),g=T(localStorage.getItem("textColor")||"rgba(255, 255, 255, 1)"),$=T(localStorage.getItem("shadowColor")||"rgba(255, 255, 255, 1)"),D=T([]),j=yt(()=>{var i,b;const s=((b=(i=t.songData)==null?void 0:i.player)==null?void 0:b.seekbarCurrentPositionHuman.split(":"))||0,c=parseInt(s[0])*60+parseInt(s[1]);let u=-1;for(let h=t.lyricData.lyric.length-1;h>=0;h--){const f=t.lyricData.lyric[h][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(f){const w=parseInt(f[1])*60+parseInt(f[2]);if(c>=w){u=h;break}}}let y=0;t.lyricData.translatedLyric.length===0?y=-(u-1)*67:y=-u*100;const m=document.querySelector(".lyric-box");return m&&(m.style.transform="translateY(".concat(y,"px)")),u}),ut=()=>{var u,y;const s=new kt,c=new Image;c.src=pt((y=(u=t.songData)==null?void 0:u.track)==null?void 0:y.cover),c.onload=function(){const m=s.getColor(c);z.value="rgba(".concat(m.join(","),", 1)"),g.value="rgba(".concat(m.map(i=>255-i).join(","),", 1)"),$.value="rgba(".concat(m.map(i=>255-i).join(","),", 1)"),D.value=s.getPalette(c).map(i=>"rgba(".concat(i.join(","),", 1)"))}};return JSON.parse(localStorage.getItem("isCustomColor"))||mt(()=>{var s,c;return(c=(s=t.songData)==null?void 0:s.track)==null?void 0:c.cover},(s,c)=>{s&&s!==c&&ut()}),_t(()=>{t.resetSongData(),P()}),(s,c)=>(r(),S(a(ft),{width:1880,height:280,"box-style":{backgroundColor:"none"}},{default:p(()=>{var u,y,m,i,b,h,f,w,V,q,O,E,J,A,F,M,U,W,X,Y,G,K,Q,R,Z,tt,at,et,ot,rt;return[n("div",{class:"song-container",style:st({"--theme-color":z.value,"--text-color":g.value,"--bg-color":D.value[2]||g.value,"--shadow-color":$.value,"--stress-color":D.value[3]})},[lt(ct(vt,{name:"fade",mode:"out-in"},{default:p(()=>{var e,o,x,C;return[(r(),l("img",{id:"cover",class:"cover",key:(o=(e=a(t).songData)==null?void 0:e.track)==null?void 0:o.cover,src:(C=(x=a(t).songData)==null?void 0:x.track)==null?void 0:C.cover,alt:"封面"},null,8,bt))]}),_:1},512),[[nt,(y=(u=a(t).songData)==null?void 0:u.track)==null?void 0:y.cover]]),lt(n("img",xt,null,512),[[nt,!((i=(m=a(t).songData)==null?void 0:m.track)!=null&&i.cover)]]),n("div",Ct,[v.some(e=>e.length>0)?(r(),l("div",St,[(r(),l("div",{key:a(k)},[ct(I,{color:g.value,"is-bold":"bold","content-align":"space-evenly"},{default:p(()=>[(r(!0),l(L,null,H(v[a(k)],(e,o)=>(r(),l(L,null,[n("span",null,d(e),1),o<v[a(k)].length-1?(r(),l("span",It,"|")):_("",!0)],64))),256))]),_:1},8,["color"])]))])):_("",!0),v.some(e=>e.length!==0)?(r(),l("div",wt,[(h=(b=a(t).songData)==null?void 0:b.track)!=null&&h.title?(r(),S(I,{key:0,color:g.value,"is-bold":"bold"},{default:p(()=>{var e,o;return[N(d((o=(e=a(t).songData)==null?void 0:e.track)==null?void 0:o.title),1)]}),_:1},8,["color"])):_("",!0),(w=(f=a(t).songData)==null?void 0:f.track)!=null&&w.title&&((q=(V=a(t).songData)==null?void 0:V.track)!=null&&q.author)?(r(),l("span",Tt,"-")):_("",!0),(E=(O=a(t).songData)==null?void 0:O.track)!=null&&E.author?(r(),S(I,{key:2,color:g.value,"font-size":"35px"},{default:p(()=>{var e,o;return[N(d((o=(e=a(t).songData)==null?void 0:e.track)==null?void 0:o.author),1)]}),_:1},8,["color"])):_("",!0),!((A=(J=a(t).songData)==null?void 0:J.track)!=null&&A.title)&&!((M=(F=a(t).songData)==null?void 0:F.track)!=null&&M.author)?(r(),l("span",Lt,"暂无歌曲信息")):_("",!0)])):(r(),l("div",Nt,[(W=(U=a(t).songData)==null?void 0:U.track)!=null&&W.title?(r(),S(I,{key:0,color:g.value,"is-bold":"bold"},{default:p(()=>{var e,o;return[N(d((o=(e=a(t).songData)==null?void 0:e.track)==null?void 0:o.title),1)]}),_:1},8,["color"])):_("",!0),(Y=(X=a(t).songData)==null?void 0:X.track)!=null&&Y.author?(r(),S(I,{key:1,color:g.value,"font-size":"35px"},{default:p(()=>{var e,o;return[N(d((o=(e=a(t).songData)==null?void 0:e.track)==null?void 0:o.author),1)]}),_:1},8,["color"])):_("",!0),!((K=(G=a(t).songData)==null?void 0:G.track)!=null&&K.title)&&!((R=(Q=a(t).songData)==null?void 0:Q.track)!=null&&R.author)?(r(),l("span",zt,"暂无歌曲信息")):_("",!0)])),n("div",Bt,[n("span",null,d((tt=(Z=a(t).songData)==null?void 0:Z.player)==null?void 0:tt.seekbarCurrentPositionHuman),1),n("div",{class:"process-bar",style:st({"--bg-color":D.value[2]||z.value,"--stress-color":D.value[3]||g.value,"--process":((et=(at=a(t).songData)==null?void 0:at.player)==null?void 0:et.statePercent)||0})},null,4),n("span",null,d((rt=(ot=a(t).songData)==null?void 0:ot.track)==null?void 0:rt.durationHuman),1)])]),n("div",Ht,[a(t).lyricData.lyric.length>0?(r(),l("div",Pt,[a(t).lyricData.translatedLyric.length===0?(r(!0),l(L,{key:0},H(a(t).lyricData.lyric,(e,o)=>(r(),l("div",{class:it(["lyric-line",{active:o===j.value}]),key:o},[n("span",null,d(e[2]),1)],2))),128)):(r(!0),l(L,{key:1},H(a(t).lyricData.lyric,(e,o)=>{var x,C;return r(),l("div",{class:it(["lyric-line-translated",{active:o===j.value}]),key:o},[n("span",$t,d((x=a(t).lyricData.translatedLyric.find(B=>B[1]===a(t).lyricData.lyric[o][1]))!=null&&x[2]?e[2]:""),1),n("span",jt,d(((C=a(t).lyricData.translatedLyric.find(B=>B[1]===a(t).lyricData.lyric[o][1]))==null?void 0:C[2])||e[2]),1)],2)}),128))])):(r(),l("div",Vt,"暂无歌词"))])],4)]}),_:1}))}},Wt=Dt(qt,[["__scopeId","data-v-f0f6aded"]]);export{Wt as default};
