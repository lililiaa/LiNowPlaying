import{b2 as V,aC as P,B as T,v as Y,D as I,C as q,a0 as v,a1 as h,u as a,U as o,Y as l,a8 as z,ad as H,Z as D,au as $,T as n,W as u,ah as F,X as b,a$ as w,a7 as i,aQ as x}from"./index-DAzvFF62.js";import{_ as J,a as M}from"./plugin-vueexport-helper-DwRewS5w.js";import{u as O}from"./color-thief-DF3QbzqH.js";import{T as Q,o as p}from"./v-scale-screen-CZtUN8GV.js";const U=["src"],W={class:"basic-info"},X={key:0,class:"game-info"},Z={key:0},A={key:1,class:"song-info"},G={key:2},K={key:2,class:"song-info2"},R={key:2},tt={class:"process-box"},at={class:"lyric-info"},et={key:0,class:"lyric-box"},ot={class:"original"},st={class:"translated"},rt={key:1,class:"lyric-empty"},nt={class:"lyric-bg"},lt=["src"],ct={__name:"Home2",setup(it){const t=V(),d=P(JSON.parse(localStorage.getItem("extraInfo")));let m=0;const L=()=>{let e=m;do e=(e+1)%d.length;while(d[e].length===0&&e!==m);d[e].length>0&&(m=e),setTimeout(L,8e3)},B=T("rgba(0, 0, 0, 0.8)"),g=T("rgba(255, 255, 255, 1)"),_=T([]),N=Y(()=>{const e=t.songData?.player?.seekbarCurrentPositionHuman.split(":")||0,c=parseInt(e[0])*60+parseInt(e[1]);let s=-1;for(let f=t.lyricData.lyric.length-1;f>=0;f--){const S=t.lyricData.lyric[f][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(S){const E=parseInt(S[1])*60+parseInt(S[2]);if(c>=E){s=f;break}}}let r=0;t.lyricData.translatedLyric.length===0?r=-(s-1)*67:r=-s*100;const k=document.querySelector(".lyric-box");return k&&(k.style.transform=`translateY(${r}px)`),s}),j=()=>{const e=new O,c=document.getElementsByClassName("cover")[0];c.onload=function(){const s=e.getColor(c);B.value=`rgba(${s.join(",")}, 1)`,g.value=`rgba(${s.map(r=>255-r).join(",")}, 1)`,_.value=e.getPalette(c).map(r=>`rgba(${r.join(",")}, 1)`)}};I(()=>t.songData?.track?.cover,(e,c)=>{e&&e!==c&&j()});const y=P({status:"已暂停",name:"暂无歌曲"}),C=()=>{y.status&&y.name?document.title=y.status+" - "+y.name:document.title="歌曲组件"};return I(()=>t.songData?.player?.isPaused,e=>{e?y.status="已暂停":y.status="播放中",C()}),I(()=>t.songData?.track?.title,e=>{y.name=e,C()}),q(()=>{C(),t.resetSongData(),L()}),(e,c)=>(o(),v(a(Q),{width:"1880",height:"280","box-style":{backgroundColor:e.none}},{default:h(()=>[l("div",{class:"song-container",style:z({"--theme-color":B.value,"--text-color":g.value,"--bg-color":_.value[2],"--stress-color":_.value[3]})},[H(l("img",{id:"cover",class:D(["cover",{changing:a(t).isChanging}]),src:a(t).songData?.track?.cover,alt:"封面"},null,10,U),[[$,a(t).songData?.track?.cover]]),H(l("img",{class:D(["cover",{changing:a(t).isChanging}]),style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:M,alt:""},null,2),[[$,!a(t).songData?.track?.cover]]),l("div",W,[d.some(s=>s.length>0)?(o(),n("div",X,[(o(),n("div",{key:a(m)},[F(p,{color:g.value,"is-bold":"bold","content-align":"space-evenly"},{default:h(()=>[(o(!0),n(b,null,w(d[a(m)],(s,r)=>(o(),n(b,null,[l("span",null,i(s),1),r<d[a(m)].length-1?(o(),n("span",Z,"|")):u("",!0)],64))),256))]),_:1},8,["color"])]))])):u("",!0),d.some(s=>s.length!==0)?(o(),n("div",A,[a(t).songData?.track?.title?(o(),v(p,{key:0,color:g.value,"is-bold":"bold"},{default:h(()=>[x(i(a(t).songData?.track?.title),1)]),_:1},8,["color"])):u("",!0),c[0]||(c[0]=l("span",null,"-",-1)),a(t).songData?.track?.author?(o(),v(p,{key:1,color:g.value,"font-size":"35px"},{default:h(()=>[x(i(a(t).songData?.track?.author),1)]),_:1},8,["color"])):u("",!0),!a(t).songData?.track?.title&&!a(t).songData?.track?.author?(o(),n("span",G,"暂无歌曲信息")):u("",!0)])):(o(),n("div",K,[a(t).songData?.track?.title?(o(),v(p,{key:0,color:g.value,"is-bold":"bold"},{default:h(()=>[x(i(a(t).songData?.track?.title),1)]),_:1},8,["color"])):u("",!0),a(t).songData?.track?.author?(o(),v(p,{key:1,color:g.value,"font-size":"35px"},{default:h(()=>[x(i(a(t).songData?.track?.author),1)]),_:1},8,["color"])):u("",!0),!a(t).songData?.track?.title&&!a(t).songData?.track?.author?(o(),n("span",R,"暂无歌曲信息")):u("",!0)])),l("div",tt,[l("span",null,i(a(t).songData?.player?.seekbarCurrentPositionHuman),1),l("div",{class:"process-bar",style:z({"--bg-color":_.value[2],"--stress-color":_.value[3],"--process":a(t).songData?.player?.statePercent||0})},null,4),l("span",null,i(a(t).songData?.track?.durationHuman),1)])]),l("div",at,[a(t).lyricData.lyric.length>0?(o(),n("div",et,[a(t).lyricData.translatedLyric.length===0?(o(!0),n(b,{key:0},w(a(t).lyricData.lyric,(s,r)=>(o(),n("div",{class:D(["lyric-line",{active:r===N.value}]),key:r},[l("span",null,i(s[2]),1)],2))),128)):(o(!0),n(b,{key:1},w(a(t).lyricData.lyric,(s,r)=>(o(),n("div",{class:D(["lyric-line-translated",{active:r===N.value}]),key:r},[l("span",ot,i(s[2]),1),l("span",st,i(a(t).lyricData.translatedLyric.find(k=>k[1]===a(t).lyricData.lyric[r][1])?.[2]||""),1)],2))),128))])):(o(),n("div",rt,"暂无歌词")),l("div",nt,[(o(),n("img",{key:a(t).songData?.track?.cover,src:a(t).songData?.track?.cover,alt:""},null,8,lt))])])],4)]),_:1},8,["box-style"]))}},mt=J(ct,[["__scopeId","data-v-eb55db24"]]);export{mt as default};
