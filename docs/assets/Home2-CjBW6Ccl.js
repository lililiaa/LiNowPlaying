import{c3 as _t,aK as gt,a1 as w,X as vt,a3 as $,a2 as pt,as as C,at as D,L as a,am as r,ap as c,aA as dt,aE as yt,aq as T,aF as mt,al as n,an as h,aH as kt,ao as L,bd as j,az as g,bb as z}from"./index-EYVoQ1Fb.js";import{_ as ft}from"./music-Def25HgW.js";import{g as Dt,u as bt}from"./cover-DzIuO3oK.js";import{T as xt,o as S}from"./v-scale-screen-pqug9WN0.js";import{_ as Ct}from"./plugin-vueexport-helper-DlAUqK2U.js";const St=["src"],It={class:"basic-info"},wt={key:0,class:"game-info"},Tt={key:0},Lt={key:1,class:"song-info"},zt={key:1},Ht={key:3},Nt={key:2,class:"song-info2"},Pt={key:2},$t={class:"process-box"},jt={class:"lyric-info"},Bt={key:0,class:"lyric-box"},Et={class:"original"},Vt={class:"translated"},qt={key:1,class:"lyric-empty"},Ft={__name:"Home2",setup(Jt){const t=_t(),_=gt(JSON.parse(localStorage.getItem("extraInfo")));let k=0;const B=()=>{let e=k;do e=(e+1)%_.length;while(_[e].length===0&&e!==k);_[e].length>0&&(k=e),setTimeout(B,8e3)},H=w(localStorage.getItem("backgroundColor")||"rgba(0, 0, 0, 0.8)"),d=w(localStorage.getItem("textColor")||"rgba(255, 255, 255, 1)"),E=w(localStorage.getItem("shadowColor")||"rgba(255, 255, 255, 1)"),b=w([]),V=vt(()=>{var i,x;const e=((x=(i=t.songData)==null?void 0:i.player)==null?void 0:x.seekbarCurrentPositionHuman.split(":"))||0,l=parseInt(e[0])*60+parseInt(e[1]);let u=-1;for(let p=t.lyricData.lyric.length-1;p>=0;p--){const f=t.lyricData.lyric[p][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(f){const I=parseInt(f[1])*60+parseInt(f[2]);if(l>=I){u=p;break}}}let y=0;t.lyricData.translatedLyric.length===0?y=-(u-1)*67:y=-u*100;const m=document.querySelector(".lyric-box");return m&&(m.style.transform="translateY(".concat(y,"px)")),u}),ht=()=>{var u,y;const e=new bt,l=new Image;l.src=Dt((y=(u=t.songData)==null?void 0:u.track)==null?void 0:y.cover),l.onload=function(){const m=e.getColor(l);H.value="rgba(".concat(m.join(","),", 1)"),d.value="rgba(".concat(m.map(i=>255-i).join(","),", 1)"),E.value="rgba(".concat(m.map(i=>255-i).join(","),", 1)"),b.value=e.getPalette(l).map(i=>"rgba(".concat(i.join(","),", 1)"))}};JSON.parse(localStorage.getItem("isCustomColor"))||$(()=>{var e,l;return(l=(e=t.songData)==null?void 0:e.track)==null?void 0:l.cover},(e,l)=>{e&&e!==l&&ht()});const v=gt({status:"已暂停",name:"暂无歌曲"}),N=()=>{v.status&&v.name?document.title=v.status+" - "+v.name:document.title="歌曲组件"};return $(()=>{var e,l;return(l=(e=t.songData)==null?void 0:e.player)==null?void 0:l.isPaused},e=>{e?v.status="已暂停":v.status="播放中",N()}),$(()=>{var e,l;return(l=(e=t.songData)==null?void 0:e.track)==null?void 0:l.title},e=>{v.name=e,N()}),pt(()=>{N(),t.resetSongData(),B()}),(e,l)=>(r(),C(a(xt),{width:1880,height:280,"box-style":{backgroundColor:"none"}},{default:D(()=>{var u,y,m,i,x,p,f,I,q,F,J,O,A,K,M,U,X,Y,G,Q,R,W,Z,tt,at,et,ot,st,rt,lt,nt,ct;return[c("div",{class:"song-container",style:dt({"--theme-color":H.value,"--text-color":d.value,"--bg-color":b.value[2]||d.value,"--shadow-color":E.value,"--stress-color":b.value[3]})},[yt(c("img",{id:"cover",class:T(["cover",{changing:a(t).isChanging}]),src:(y=(u=a(t).songData)==null?void 0:u.track)==null?void 0:y.cover,alt:"封面"},null,10,St),[[mt,(i=(m=a(t).songData)==null?void 0:m.track)==null?void 0:i.cover]]),yt(c("img",{class:T(["cover",{changing:a(t).isChanging}]),style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:ft,alt:""},null,2),[[mt,!((p=(x=a(t).songData)==null?void 0:x.track)!=null&&p.cover)]]),c("div",It,[_.some(o=>o.length>0)?(r(),n("div",wt,[(r(),n("div",{key:a(k)},[kt(S,{color:d.value,"is-bold":"bold","content-align":"space-evenly"},{default:D(()=>[(r(!0),n(L,null,j(_[a(k)],(o,s)=>(r(),n(L,null,[c("span",null,g(o),1),s<_[a(k)].length-1?(r(),n("span",Tt,"|")):h("",!0)],64))),256))]),_:1},8,["color"])]))])):h("",!0),_.some(o=>o.length!==0)?(r(),n("div",Lt,[(I=(f=a(t).songData)==null?void 0:f.track)!=null&&I.title?(r(),C(S,{key:0,color:d.value,"is-bold":"bold"},{default:D(()=>{var o,s;return[z(g((s=(o=a(t).songData)==null?void 0:o.track)==null?void 0:s.title),1)]}),_:1},8,["color"])):h("",!0),(F=(q=a(t).songData)==null?void 0:q.track)!=null&&F.title&&((O=(J=a(t).songData)==null?void 0:J.track)!=null&&O.author)?(r(),n("span",zt,"-")):h("",!0),(K=(A=a(t).songData)==null?void 0:A.track)!=null&&K.author?(r(),C(S,{key:2,color:d.value,"font-size":"35px"},{default:D(()=>{var o,s;return[z(g((s=(o=a(t).songData)==null?void 0:o.track)==null?void 0:s.author),1)]}),_:1},8,["color"])):h("",!0),!((U=(M=a(t).songData)==null?void 0:M.track)!=null&&U.title)&&!((Y=(X=a(t).songData)==null?void 0:X.track)!=null&&Y.author)?(r(),n("span",Ht,"暂无歌曲信息")):h("",!0)])):(r(),n("div",Nt,[(Q=(G=a(t).songData)==null?void 0:G.track)!=null&&Q.title?(r(),C(S,{key:0,color:d.value,"is-bold":"bold"},{default:D(()=>{var o,s;return[z(g((s=(o=a(t).songData)==null?void 0:o.track)==null?void 0:s.title),1)]}),_:1},8,["color"])):h("",!0),(W=(R=a(t).songData)==null?void 0:R.track)!=null&&W.author?(r(),C(S,{key:1,color:d.value,"font-size":"35px"},{default:D(()=>{var o,s;return[z(g((s=(o=a(t).songData)==null?void 0:o.track)==null?void 0:s.author),1)]}),_:1},8,["color"])):h("",!0),!((tt=(Z=a(t).songData)==null?void 0:Z.track)!=null&&tt.title)&&!((et=(at=a(t).songData)==null?void 0:at.track)!=null&&et.author)?(r(),n("span",Pt,"暂无歌曲信息")):h("",!0)])),c("div",$t,[c("span",null,g((st=(ot=a(t).songData)==null?void 0:ot.player)==null?void 0:st.seekbarCurrentPositionHuman),1),c("div",{class:"process-bar",style:dt({"--bg-color":b.value[2]||H.value,"--stress-color":b.value[3]||d.value,"--process":((lt=(rt=a(t).songData)==null?void 0:rt.player)==null?void 0:lt.statePercent)||0})},null,4),c("span",null,g((ct=(nt=a(t).songData)==null?void 0:nt.track)==null?void 0:ct.durationHuman),1)])]),c("div",jt,[a(t).lyricData.lyric.length>0?(r(),n("div",Bt,[a(t).lyricData.translatedLyric.length===0?(r(!0),n(L,{key:0},j(a(t).lyricData.lyric,(o,s)=>(r(),n("div",{class:T(["lyric-line",{active:s===V.value}]),key:s},[c("span",null,g(o[2]),1)],2))),128)):(r(!0),n(L,{key:1},j(a(t).lyricData.lyric,(o,s)=>{var it,ut;return r(),n("div",{class:T(["lyric-line-translated",{active:s===V.value}]),key:s},[c("span",Et,g((it=a(t).lyricData.translatedLyric.find(P=>P[1]===a(t).lyricData.lyric[s][1]))!=null&&it[2]?o[2]:""),1),c("span",Vt,g(((ut=a(t).lyricData.translatedLyric.find(P=>P[1]===a(t).lyricData.lyric[s][1]))==null?void 0:ut[2])||o[2]),1)],2)}),128))])):(r(),n("div",qt,"暂无歌词"))])],4)]}),_:1}))}},Xt=Ct(Ft,[["__scopeId","data-v-9d322cfa"]]);export{Xt as default};
