import{b2 as q,aC as L,B as b,v as H,D as x,C as V,a0 as C,a1 as h,u as e,U as s,Y as c,a8 as w,T as n,X as d,a$ as _,Z as f,a7 as y,ad as B,au as N,W as v,ah as E,aQ as z}from"./index-J6xnNl_S.js";import{_ as Y,a as F}from"./_plugin-vue_export-helper-DwRewS5w.js";import{u as J}from"./color-thief-DF3QbzqH.js";import{T as M,o as S}from"./v-scale-screen-Bi8YDtIJ.js";const O={class:"lyric-container"},Q={key:0,class:"lyric-box"},U={class:"original"},W={class:"translated"},X={key:1,class:"lyric-empty"},Z={class:"other-container"},A=["src"],G={key:0,class:"extra-container"},K={key:0},R={class:"song-container"},tt={key:2},et={__name:"Home3",setup(at){const t=q(),P=L(JSON.parse(localStorage.getItem("extraInfo"))),I=b("rgba(0, 0, 0, 0.8)"),m=b("rgba(255, 255, 255, 1)"),p=b([]),T=H(()=>{const r=t.songData?.player?.seekbarCurrentPositionHuman.split(":")||0,l=parseInt(r[0])*60+parseInt(r[1]);let o=-1;for(let g=t.lyricData.lyric.length-1;g>=0;g--){const D=t.lyricData.lyric[g][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(D){const j=parseInt(D[1])*60+parseInt(D[2]);if(l>=j){o=g;break}}}let a=0;t.lyricData.translatedLyric.length===0?a=-(o-3)*100:a=-(o-2)*160;const u=document.querySelector(".lyric-box");return u&&(u.style.transform=`translateY(${a}px)`),o}),$=()=>{const r=new J,l=document.getElementsByClassName("cover")[0];l.onload=function(){const o=r.getColor(l);I.value=`rgba(${o.join(",")}, 1)`,m.value=`rgba(${o.map(a=>255-a).join(",")}, 1)`,p.value=r.getPalette(l).map(a=>`rgba(${a.join(",")}, 1)`)}};x(()=>t.songData?.track?.cover,(r,l)=>{r&&r!==l&&$()});const i=L({status:"已暂停",name:"暂无歌曲"}),k=()=>{i.status&&i.name?document.title=i.status+" - "+i.name:document.title="歌曲组件"};return x(()=>t.songData?.player?.isPaused,r=>{r?i.status="已暂停":i.status="播放中",k()}),x(()=>t.songData?.track?.title,r=>{i.name=r,k()}),V(()=>{k(),t.resetSongData()}),(r,l)=>(s(),C(e(M),{width:"1880",height:"880","box-style":{backgroundColor:r.none}},{default:h(()=>[c("div",{class:"main",style:w({"--theme-color":I.value,"--text-color":m.value,"--bg-color":p.value[2],"--stress-color":p.value[3]})},[c("div",O,[e(t).lyricData.lyric.length>0?(s(),n("div",Q,[e(t).lyricData.translatedLyric.length===0?(s(!0),n(d,{key:0},_(e(t).lyricData.lyric,(o,a)=>(s(),n("div",{class:f(["lyric-line",{active:a===T.value}]),key:a},[c("span",null,y(o[2]),1)],2))),128)):(s(!0),n(d,{key:1},_(e(t).lyricData.lyric,(o,a)=>(s(),n("div",{class:f(["lyric-line-translated",{active:a===T.value}]),key:a},[c("span",U,y(o[2]),1),c("span",W,y(e(t).lyricData.translatedLyric.find(u=>u[1]===e(t).lyricData.lyric[a][1])?.[2]||""),1)],2))),128))])):(s(),n("div",X,"暂无歌词"))]),c("div",Z,[B(c("img",{id:"cover",class:f(["cover",{changing:e(t).isChanging}]),crossorigin:"anonymous",src:e(t).songData?.track?.cover?e(t).songData?.track?.cover.replace("https://y.qq.com","/image"):"",alt:"封面"},null,10,A),[[N,e(t).songData?.track?.cover]]),B(c("img",{class:f(["cover",{changing:e(t).isChanging}]),style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:F,alt:""},null,2),[[N,!e(t).songData?.track?.cover]]),(s(!0),n(d,null,_(P,(o,a)=>(s(),n(d,{key:a},[o.length>0?(s(),n("div",G,[E(S,{color:m.value,"content-align":"space-evenly"},{default:h(()=>[(s(!0),n(d,null,_(o,(u,g)=>(s(),n(d,null,[c("span",null,y(u),1),g<o.length-1?(s(),n("span",K,"|")):v("",!0)],64))),256))]),_:2},1032,["color"])])):v("",!0)],64))),128)),c("div",R,[e(t).songData?.track?.title?(s(),C(S,{key:0,color:m.value,"is-bold":"bold","font-size":"50px"},{default:h(()=>[z(y(e(t).songData?.track?.title),1)]),_:1},8,["color"])):v("",!0),e(t).songData?.track?.author?(s(),C(S,{key:1,color:m.value,"font-size":"40px"},{default:h(()=>[z(y(e(t).songData?.track?.author),1)]),_:1},8,["color"])):v("",!0),!e(t).songData?.track?.title&&!e(t).songData?.track?.author?(s(),n("span",tt,"暂无歌曲信息")):v("",!0)]),c("div",{class:"process-container",style:w({"--bg-color":p.value[2],"--stress-color":p.value[3],"--process":e(t).songData?.player?.statePercent||0})},null,4)])],4)]),_:1},8,["box-style"]))}},ct=Y(et,[["__scopeId","data-v-a7e8fac7"]]);export{ct as default};
