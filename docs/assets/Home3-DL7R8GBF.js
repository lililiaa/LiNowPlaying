import{c3 as W,aK as M,a1 as S,X as Z,a3 as P,a2 as tt,as as $,at as I,L as e,am as r,ap as i,aA as U,al as c,ao as _,bd as w,aq as L,az as h,aE as X,aF as Y,an as D,aH as at,bb as G}from"./index-EYVoQ1Fb.js";import{_ as et}from"./music-Def25HgW.js";import{g as ot,u as rt}from"./cover-DzIuO3oK.js";import{T as st,o as j}from"./v-scale-screen-pqug9WN0.js";import{_ as lt}from"./plugin-vueexport-helper-DlAUqK2U.js";const ct={class:"lyric-container"},nt={key:0,class:"lyric-box"},it={class:"original"},ut={class:"translated"},gt={key:1,class:"lyric-empty"},dt={class:"other-container"},yt=["src"],mt={key:0,class:"extra-container"},vt={key:0},pt={class:"song-container"},_t={key:2},ht={__name:"Home3",setup(ft){const t=W(),Q=M(JSON.parse(localStorage.getItem("extraInfo"))),T=S(localStorage.getItem("backgroundColor")||"rgba(0, 0, 0, 0.8)"),y=S(localStorage.getItem("textColor")||"rgba(255, 255, 255, 1)"),B=S(localStorage.getItem("shadowColor")||"rgba(255, 255, 255, 1)"),f=S([]),H=Z(()=>{var n,k;const a=((k=(n=t.songData)==null?void 0:n.player)==null?void 0:k.seekbarCurrentPositionHuman.split(":"))||0,o=parseInt(a[0])*60+parseInt(a[1]);let u=-1;for(let v=t.lyricData.lyric.length-1;v>=0;v--){const p=t.lyricData.lyric[v][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(p){const b=parseInt(p[1])*60+parseInt(p[2]);if(o>=b){u=v;break}}}let g=0;t.lyricData.translatedLyric.length===0?g=-(u-3)*100:g=-(u-2)*160;const d=document.querySelector(".lyric-box");return d&&(d.style.transform="translateY(".concat(g,"px)")),u}),R=()=>{var u,g;const a=new rt,o=new Image;o.src=ot((g=(u=t.songData)==null?void 0:u.track)==null?void 0:g.cover),o.onload=function(){const d=a.getColor(o);T.value="rgba(".concat(d.join(","),", 1)"),y.value="rgba(".concat(d.map(n=>255-n).join(","),", 1)"),B.value="rgba(".concat(d.map(n=>255-n).join(","),", 1)"),f.value=a.getPalette(o).map(n=>"rgba(".concat(n.join(","),", 1)"))}};JSON.parse(localStorage.getItem("isCustomColor"))||P(()=>{var a,o;return(o=(a=t.songData)==null?void 0:a.track)==null?void 0:o.cover},(a,o)=>{a&&a!==o&&R()});const m=M({status:"已暂停",name:"暂无歌曲"}),z=()=>{m.status&&m.name?document.title=m.status+" - "+m.name:document.title="歌曲组件"};return P(()=>{var a,o;return(o=(a=t.songData)==null?void 0:a.player)==null?void 0:o.isPaused},a=>{a?m.status="已暂停":m.status="播放中",z()}),P(()=>{var a,o;return(o=(a=t.songData)==null?void 0:a.track)==null?void 0:o.title},a=>{m.name=a,z()}),tt(()=>{z(),t.resetSongData()}),(a,o)=>(r(),$(e(st),{width:1880,height:880,"box-style":{backgroundColor:"none"}},{default:I(()=>{var u,g,d,n,k,v,p,b,V,q,E,F,J,O,A,K;return[i("div",{class:"main",style:U({"--theme-color":T.value,"--text-color":y.value,"--bg-color":f.value[2]||y.value,"--shadow-color":B.value,"--stress-color":f.value[3]})},[i("div",ct,[e(t).lyricData.lyric.length>0?(r(),c("div",nt,[e(t).lyricData.translatedLyric.length===0?(r(!0),c(_,{key:0},w(e(t).lyricData.lyric,(l,s)=>(r(),c("div",{class:L(["lyric-line",{active:s===H.value}]),key:s},[i("span",null,h(l[2]),1)],2))),128)):(r(!0),c(_,{key:1},w(e(t).lyricData.lyric,(l,s)=>{var x,C;return r(),c("div",{class:L(["lyric-line-translated",{active:s===H.value}]),key:s},[i("span",it,h((x=e(t).lyricData.translatedLyric.find(N=>N[1]===e(t).lyricData.lyric[s][1]))!=null&&x[2]?l[2]:""),1),i("span",ut,h(((C=e(t).lyricData.translatedLyric.find(N=>N[1]===e(t).lyricData.lyric[s][1]))==null?void 0:C[2])||l[2]),1)],2)}),128))])):(r(),c("div",gt,"暂无歌词"))]),i("div",dt,[X(i("img",{id:"cover",class:L(["cover",{changing:e(t).isChanging}]),src:(g=(u=e(t).songData)==null?void 0:u.track)==null?void 0:g.cover,alt:"封面"},null,10,yt),[[Y,(n=(d=e(t).songData)==null?void 0:d.track)==null?void 0:n.cover]]),X(i("img",{class:L(["cover",{changing:e(t).isChanging}]),style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:et,alt:""},null,2),[[Y,!((v=(k=e(t).songData)==null?void 0:k.track)!=null&&v.cover)]]),(r(!0),c(_,null,w(Q,(l,s)=>(r(),c(_,{key:s},[l.length>0?(r(),c("div",mt,[at(j,{color:y.value,"content-align":"space-evenly"},{default:I(()=>[(r(!0),c(_,null,w(l,(x,C)=>(r(),c(_,null,[i("span",null,h(x),1),C<l.length-1?(r(),c("span",vt,"|")):D("",!0)],64))),256))]),_:2},1032,["color"])])):D("",!0)],64))),128)),i("div",pt,[(b=(p=e(t).songData)==null?void 0:p.track)!=null&&b.title?(r(),$(j,{key:0,color:y.value,"is-bold":"bold","font-size":"50px"},{default:I(()=>{var l,s;return[G(h((s=(l=e(t).songData)==null?void 0:l.track)==null?void 0:s.title),1)]}),_:1},8,["color"])):D("",!0),(q=(V=e(t).songData)==null?void 0:V.track)!=null&&q.author?(r(),$(j,{key:1,color:y.value,"font-size":"40px"},{default:I(()=>{var l,s;return[G(h((s=(l=e(t).songData)==null?void 0:l.track)==null?void 0:s.author),1)]}),_:1},8,["color"])):D("",!0),!((F=(E=e(t).songData)==null?void 0:E.track)!=null&&F.title)&&!((O=(J=e(t).songData)==null?void 0:J.track)!=null&&O.author)?(r(),c("span",_t,"暂无歌曲信息")):D("",!0)]),i("div",{class:"process-container",style:U({"--bg-color":f.value[2]||T.value,"--stress-color":f.value[3]||y.value,"--process":((K=(A=e(t).songData)==null?void 0:A.player)==null?void 0:K.statePercent)||0})},null,4)])],4)]}),_:1}))}},St=lt(ht,[["__scopeId","data-v-6569162e"]]);export{St as default};
