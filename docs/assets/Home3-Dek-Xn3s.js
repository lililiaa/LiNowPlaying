import{bS as X,av as Y,r as S,c as G,w as K,o as Q,N as T,B as b,u as a,s as r,v as u,x as O,p as s,O as h,W as I,y as J,V as f,an as A,A as E,aq as R,ap as F,q as x,X as M}from"./index-DUkU98TY.js";import{_ as Z}from"./music-Def25HgW.js";import{g as tt,u as at}from"./cover-DzIuO3oK.js";import{o as N}from"./overflowText-MHgtVsfW.js";import{T as et}from"./v-scale-screen-C8hdMqua.js";import{_ as ot}from"./plugin-vueexport-helper-DlAUqK2U.js";const rt={class:"lyric-container"},st={key:0,class:"lyric-box"},lt={class:"original"},ct={class:"translated"},nt={key:1,class:"lyric-empty"},it={class:"other-container"},ut=["src"],dt={class:"cover",style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:Z,alt:""},gt={key:0,class:"extra-container"},yt={key:0},mt={class:"song-container"},vt={key:2},pt={__name:"Home3",setup(_t){const t=X(),U=Y(JSON.parse(localStorage.getItem("extraInfo"))),w=S(localStorage.getItem("backgroundColor")||"rgba(0, 0, 0, 0.8)"),y=S(localStorage.getItem("textColor")||"rgba(255, 255, 255, 1)"),z=S(localStorage.getItem("shadowColor")||"rgba(255, 255, 255, 1)"),k=S([]),B=G(()=>{var n,D;const l=((D=(n=t.songData)==null?void 0:n.player)==null?void 0:D.seekbarCurrentPositionHuman.split(":"))||0,c=parseInt(l[0])*60+parseInt(l[1]);let i=-1;for(let m=t.lyricData.lyric.length-1;m>=0;m--){const _=t.lyricData.lyric[m][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(_){const C=parseInt(_[1])*60+parseInt(_[2]);if(c>=C){i=m;break}}}let d=0;t.lyricData.translatedLyric.length===0?d=-(i-3)*100:d=-(i-2)*160;const g=document.querySelector(".lyric-box");return g&&(g.style.transform="translateY(".concat(d,"px)")),i}),W=()=>{var i,d;const l=new at,c=new Image;c.src=tt((d=(i=t.songData)==null?void 0:i.track)==null?void 0:d.cover),c.onload=function(){const g=l.getColor(c);w.value="rgba(".concat(g.join(","),", 1)"),y.value="rgba(".concat(g.map(n=>255-n).join(","),", 1)"),z.value="rgba(".concat(g.map(n=>255-n).join(","),", 1)"),k.value=l.getPalette(c).map(n=>"rgba(".concat(n.join(","),", 1)"))}};return JSON.parse(localStorage.getItem("isCustomColor"))||K(()=>{var l,c;return(c=(l=t.songData)==null?void 0:l.track)==null?void 0:c.cover},(l,c)=>{l&&l!==c&&W()}),Q(()=>{t.resetSongData()}),(l,c)=>(r(),T(a(et),{width:1880,height:880,"box-style":{backgroundColor:"none"}},{default:b(()=>{var i,d,g,n,D,m,_,C,$,j,P,V,q,H;return[u("div",{class:"main",style:O({"--theme-color":w.value,"--text-color":y.value,"--bg-color":k.value[2]||y.value,"--shadow-color":z.value,"--stress-color":k.value[3]})},[u("div",rt,[a(t).lyricData.lyric.length>0?(r(),s("div",st,[a(t).lyricData.translatedLyric.length===0?(r(!0),s(h,{key:0},I(a(t).lyricData.lyric,(o,e)=>(r(),s("div",{class:J(["lyric-line",{active:e===B.value}]),key:e},[u("span",null,f(o[2]),1)],2))),128)):(r(!0),s(h,{key:1},I(a(t).lyricData.lyric,(o,e)=>{var v,p;return r(),s("div",{class:J(["lyric-line-translated",{active:e===B.value}]),key:e},[u("span",lt,f((v=a(t).lyricData.translatedLyric.find(L=>L[1]===a(t).lyricData.lyric[e][1]))!=null&&v[2]?o[2]:""),1),u("span",ct,f(((p=a(t).lyricData.translatedLyric.find(L=>L[1]===a(t).lyricData.lyric[e][1]))==null?void 0:p[2])||o[2]),1)],2)}),128))])):(r(),s("div",nt,"暂无歌词"))]),u("div",it,[A(E(R,{name:"fade",mode:"out-in"},{default:b(()=>{var o,e,v,p;return[(r(),s("img",{id:"cover",class:"cover",key:(e=(o=a(t).songData)==null?void 0:o.track)==null?void 0:e.cover,src:(p=(v=a(t).songData)==null?void 0:v.track)==null?void 0:p.cover,alt:"封面"},null,8,ut))]}),_:1},512),[[F,(d=(i=a(t).songData)==null?void 0:i.track)==null?void 0:d.cover]]),A(u("img",dt,null,512),[[F,!((n=(g=a(t).songData)==null?void 0:g.track)!=null&&n.cover)]]),(r(!0),s(h,null,I(U,(o,e)=>(r(),s(h,{key:e},[o.length>0?(r(),s("div",gt,[E(N,{color:y.value,"content-align":"space-evenly"},{default:b(()=>[(r(!0),s(h,null,I(o,(v,p)=>(r(),s(h,null,[u("span",null,f(v),1),p<o.length-1?(r(),s("span",yt,"|")):x("",!0)],64))),256))]),_:2},1032,["color"])])):x("",!0)],64))),128)),u("div",mt,[(m=(D=a(t).songData)==null?void 0:D.track)!=null&&m.title?(r(),T(N,{key:0,color:y.value,"is-bold":"bold","font-size":"50px"},{default:b(()=>{var o,e;return[M(f((e=(o=a(t).songData)==null?void 0:o.track)==null?void 0:e.title),1)]}),_:1},8,["color"])):x("",!0),(C=(_=a(t).songData)==null?void 0:_.track)!=null&&C.author?(r(),T(N,{key:1,color:y.value,"font-size":"40px"},{default:b(()=>{var o,e;return[M(f((e=(o=a(t).songData)==null?void 0:o.track)==null?void 0:e.author),1)]}),_:1},8,["color"])):x("",!0),!((j=($=a(t).songData)==null?void 0:$.track)!=null&&j.title)&&!((V=(P=a(t).songData)==null?void 0:P.track)!=null&&V.author)?(r(),s("span",vt,"暂无歌曲信息")):x("",!0)]),u("div",{class:"process-container",style:O({"--bg-color":k.value[2]||w.value,"--stress-color":k.value[3]||y.value,"--process":((H=(q=a(t).songData)==null?void 0:q.player)==null?void 0:H.statePercent)||0})},null,4)])],4)]}),_:1}))}},Ct=ot(pt,[["__scopeId","data-v-2f2dc14a"]]);export{Ct as default};
