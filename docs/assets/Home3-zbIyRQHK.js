import{bS as Y,av as G,r as C,c as K,w as Q,o as R,N as T,B as S,u as a,s as e,v as i,x as E,p as s,O as p,W as I,y as w,V as _,an as F,ap as M,q as k,A as Z,X as U}from"./index-DLkcM1tU.js";import{_ as tt}from"./music-Def25HgW.js";import{g as at,u as et}from"./cover-DzIuO3oK.js";import{o as z}from"./overflowText--V61kkcr.js";import{T as ot}from"./v-scale-screen-b1uMIy6X.js";import{_ as rt}from"./plugin-vueexport-helper-DlAUqK2U.js";const st={class:"lyric-container"},lt={key:0,class:"lyric-box"},ct={class:"original"},nt={class:"translated"},it={key:1,class:"lyric-empty"},gt={class:"other-container"},ut=["src"],dt={key:0,class:"extra-container"},yt={key:0},mt={class:"song-container"},vt={key:2},pt={__name:"Home3",setup(_t){const t=Y(),W=G(JSON.parse(localStorage.getItem("extraInfo"))),L=C(localStorage.getItem("backgroundColor")||"rgba(0, 0, 0, 0.8)"),y=C(localStorage.getItem("textColor")||"rgba(255, 255, 255, 1)"),B=C(localStorage.getItem("shadowColor")||"rgba(255, 255, 255, 1)"),h=C([]),$=K(()=>{var n,f;const l=((f=(n=t.songData)==null?void 0:n.player)==null?void 0:f.seekbarCurrentPositionHuman.split(":"))||0,c=parseInt(l[0])*60+parseInt(l[1]);let g=-1;for(let m=t.lyricData.lyric.length-1;m>=0;m--){const v=t.lyricData.lyric[m][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(v){const D=parseInt(v[1])*60+parseInt(v[2]);if(c>=D){g=m;break}}}let u=0;t.lyricData.translatedLyric.length===0?u=-(g-3)*100:u=-(g-2)*160;const d=document.querySelector(".lyric-box");return d&&(d.style.transform="translateY(".concat(u,"px)")),g}),X=()=>{var g,u;const l=new et,c=new Image;c.src=at((u=(g=t.songData)==null?void 0:g.track)==null?void 0:u.cover),c.onload=function(){const d=l.getColor(c);L.value="rgba(".concat(d.join(","),", 1)"),y.value="rgba(".concat(d.map(n=>255-n).join(","),", 1)"),B.value="rgba(".concat(d.map(n=>255-n).join(","),", 1)"),h.value=l.getPalette(c).map(n=>"rgba(".concat(n.join(","),", 1)"))}};return JSON.parse(localStorage.getItem("isCustomColor"))||Q(()=>{var l,c;return(c=(l=t.songData)==null?void 0:l.track)==null?void 0:c.cover},(l,c)=>{l&&l!==c&&X()}),R(()=>{t.resetSongData()}),(l,c)=>(e(),T(a(ot),{width:1880,height:880,"box-style":{backgroundColor:"none"}},{default:S(()=>{var g,u,d,n,f,m,v,D,j,P,V,H,O,q,J,A;return[i("div",{class:"main",style:E({"--theme-color":L.value,"--text-color":y.value,"--bg-color":h.value[2]||y.value,"--shadow-color":B.value,"--stress-color":h.value[3]})},[i("div",st,[a(t).lyricData.lyric.length>0?(e(),s("div",lt,[a(t).lyricData.translatedLyric.length===0?(e(!0),s(p,{key:0},I(a(t).lyricData.lyric,(r,o)=>(e(),s("div",{class:w(["lyric-line",{active:o===$.value}]),key:o},[i("span",null,_(r[2]),1)],2))),128)):(e(!0),s(p,{key:1},I(a(t).lyricData.lyric,(r,o)=>{var b,x;return e(),s("div",{class:w(["lyric-line-translated",{active:o===$.value}]),key:o},[i("span",ct,_((b=a(t).lyricData.translatedLyric.find(N=>N[1]===a(t).lyricData.lyric[o][1]))!=null&&b[2]?r[2]:""),1),i("span",nt,_(((x=a(t).lyricData.translatedLyric.find(N=>N[1]===a(t).lyricData.lyric[o][1]))==null?void 0:x[2])||r[2]),1)],2)}),128))])):(e(),s("div",it,"暂无歌词"))]),i("div",gt,[F(i("img",{id:"cover",class:w(["cover",{changing:a(t).isChanging}]),src:(u=(g=a(t).songData)==null?void 0:g.track)==null?void 0:u.cover,alt:"封面"},null,10,ut),[[M,(n=(d=a(t).songData)==null?void 0:d.track)==null?void 0:n.cover]]),F(i("img",{class:w(["cover",{changing:a(t).isChanging}]),style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:tt,alt:""},null,2),[[M,!((m=(f=a(t).songData)==null?void 0:f.track)!=null&&m.cover)]]),(e(!0),s(p,null,I(W,(r,o)=>(e(),s(p,{key:o},[r.length>0?(e(),s("div",dt,[Z(z,{color:y.value,"content-align":"space-evenly"},{default:S(()=>[(e(!0),s(p,null,I(r,(b,x)=>(e(),s(p,null,[i("span",null,_(b),1),x<r.length-1?(e(),s("span",yt,"|")):k("",!0)],64))),256))]),_:2},1032,["color"])])):k("",!0)],64))),128)),i("div",mt,[(D=(v=a(t).songData)==null?void 0:v.track)!=null&&D.title?(e(),T(z,{key:0,color:y.value,"is-bold":"bold","font-size":"50px"},{default:S(()=>{var r,o;return[U(_((o=(r=a(t).songData)==null?void 0:r.track)==null?void 0:o.title),1)]}),_:1},8,["color"])):k("",!0),(P=(j=a(t).songData)==null?void 0:j.track)!=null&&P.author?(e(),T(z,{key:1,color:y.value,"font-size":"40px"},{default:S(()=>{var r,o;return[U(_((o=(r=a(t).songData)==null?void 0:r.track)==null?void 0:o.author),1)]}),_:1},8,["color"])):k("",!0),!((H=(V=a(t).songData)==null?void 0:V.track)!=null&&H.title)&&!((q=(O=a(t).songData)==null?void 0:O.track)!=null&&q.author)?(e(),s("span",vt,"暂无歌曲信息")):k("",!0)]),i("div",{class:"process-container",style:E({"--bg-color":h.value[2]||L.value,"--stress-color":h.value[3]||y.value,"--process":((A=(J=a(t).songData)==null?void 0:J.player)==null?void 0:A.statePercent)||0})},null,4)])],4)]}),_:1}))}},Ct=rt(pt,[["__scopeId","data-v-2122506e"]]);export{Ct as default};
