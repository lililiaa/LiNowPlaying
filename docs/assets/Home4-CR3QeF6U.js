import{b2 as z,aC as B,B as x,v as V,D as C,C as E,a0 as h,a1 as v,u as e,U as s,Y as r,a8 as N,ad as P,Z as f,au as H,T as l,W as g,aQ as S,a7 as c,ah as U,X as I,a$ as T}from"./index-wjGeIqo1.js";import{_ as Y,a as q}from"./plugin-vueexport-helper-DwRewS5w.js";import{u as F}from"./color-thief-DF3QbzqH.js";import{T as J,g as M,o as k}from"./cover-BGZkr9fL.js";const O={class:"top-container"},Q=["src"],W={class:"info-container"},X={class:"top-info"},Z={key:0,class:"game-info bg-box"},A={key:1},G={class:"song-info bg-box"},K={key:2},R={class:"process-box"},tt={class:"lyric-container"},et={key:0,class:"lyric-box"},at={class:"original"},ot={class:"translated"},st={key:1,class:"lyric-empty"},rt={__name:"Home4",setup(nt){const t=z(),y=B(JSON.parse(localStorage.getItem("extraInfo"))),L=x("rgba(0, 0, 0, 0.8)"),d=x("rgba(255, 255, 255, 1)"),m=x([]),w=V(()=>{const n=t.songData?.player?.seekbarCurrentPositionHuman.split(":")||0,i=parseInt(n[0])*60+parseInt(n[1]);let o=-1;for(let p=t.lyricData.lyric.length-1;p>=0;p--){const b=t.lyricData.lyric[p][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(b){const j=parseInt(b[1])*60+parseInt(b[2]);if(i>=j){o=p;break}}}let a=0;t.lyricData.translatedLyric.length===0?a=-(o-1)*67:a=-o*100;const _=document.querySelector(".lyric-box");return _&&(_.style.transform=`translateY(${a}px)`),o}),$=()=>{const n=new F,i=document.getElementsByClassName("cover")[0];i.onload=function(){const o=n.getColor(i);L.value=`rgba(${o.join(",")}, 1)`,d.value=`rgba(${o.map(a=>255-a).join(",")}, 1)`,m.value=n.getPalette(i).map(a=>`rgba(${a.join(",")}, 1)`)}};C(()=>t.songData?.track?.cover,(n,i)=>{n&&n!==i&&$()});const u=B({status:"已暂停",name:"暂无歌曲"}),D=()=>{u.status&&u.name?document.title=u.status+" - "+u.name:document.title="歌曲组件"};return C(()=>t.songData?.player?.isPaused,n=>{n?u.status="已暂停":u.status="播放中",D()}),C(()=>t.songData?.track?.title,n=>{u.name=n,D()}),E(()=>{D(),t.resetSongData()}),(n,i)=>(s(),h(e(J),{width:"1280",height:"480","box-style":{backgroundColor:n.none}},{default:v(()=>[r("div",{class:"main",style:N({"--theme-color":L.value,"--text-color":d.value,"--bg-color":m.value[2],"--stress-color":m.value[3]})},[r("div",O,[P(r("img",{id:"cover",class:f(["cover",{changing:e(t).isChanging}]),crossorigin:"anonymous",src:e(M)(e(t).songData?.track?.cover),alt:"封面"},null,10,Q),[[H,e(t).songData?.track?.cover]]),P(r("img",{class:f(["cover",{changing:e(t).isChanging}]),style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:q,alt:""},null,2),[[H,!e(t).songData?.track?.cover]]),r("div",W,[r("div",X,[y.some(o=>o.length>0)?(s(),l("div",Z,[y[0].length>0?(s(),h(k,{key:0,color:d.value,"content-align":"center"},{default:v(()=>[S(c(y[0][0]),1)]),_:1},8,["color"])):g("",!0),y[1].length>0?(s(),l("div",A,[U(k,{color:d.value,"content-align":"space-evenly"},{default:v(()=>[(s(!0),l(I,null,T(y[1].join(" | ").split(" "),(o,a)=>(s(),l("span",{key:a},c(o),1))),128))]),_:1},8,["color"])])):g("",!0)])):g("",!0),r("div",G,[e(t).songData?.track?.title?(s(),h(k,{key:0,color:d.value,"is-bold":"bold"},{default:v(()=>[S(c(e(t).songData?.track?.title),1)]),_:1},8,["color"])):g("",!0),e(t).songData?.track?.author?(s(),h(k,{key:1,color:d.value,"font-size":"35px"},{default:v(()=>[S(c(e(t).songData?.track?.author),1)]),_:1},8,["color"])):g("",!0),!e(t).songData?.track?.title&&!e(t).songData?.track?.author?(s(),l("span",K,"暂无歌曲信息")):g("",!0)])]),r("div",R,[r("span",null,c(e(t).songData?.player?.seekbarCurrentPositionHuman),1),r("div",{class:"process-bar",style:N({"--bg-color":m.value[2],"--stress-color":m.value[3],"--process":e(t).songData?.player?.statePercent||0})},null,4),r("span",null,c(e(t).songData?.track?.durationHuman),1)])])]),r("div",tt,[e(t).lyricData.lyric.length>0?(s(),l("div",et,[e(t).lyricData.translatedLyric.length===0?(s(!0),l(I,{key:0},T(e(t).lyricData.lyric,(o,a)=>(s(),l("div",{class:f(["lyric-line",{active:a===w.value}]),key:a},[r("span",null,c(o[2]),1)],2))),128)):(s(!0),l(I,{key:1},T(e(t).lyricData.lyric,(o,a)=>(s(),l("div",{class:f(["lyric-line-translated",{active:a===w.value}]),key:a},[r("span",at,c(o[2]),1),r("span",ot,c(e(t).lyricData.translatedLyric.find(_=>_[1]===e(t).lyricData.lyric[a][1])?.[2]||""),1)],2))),128))])):(s(),l("div",st,"暂无歌词"))])],4)]),_:1},8,["box-style"]))}},dt=Y(rt,[["__scopeId","data-v-c7e542fe"]]);export{dt as default};
