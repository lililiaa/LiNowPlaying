import{bS as Q,av as R,r as S,c as Z,w as tt,o as at,N as I,B as p,u as a,s as r,v as s,x as U,an as W,A as X,aq as et,p as n,ap as Y,q as h,X as N,V as y,O as j,W as B,y as G}from"./index-DUkU98TY.js";import{_ as ot}from"./music-Def25HgW.js";import{g as rt,u as st}from"./cover-DzIuO3oK.js";import{o as w}from"./overflowText-MHgtVsfW.js";import{T as lt}from"./v-scale-screen-C8hdMqua.js";import{_ as ct}from"./plugin-vueexport-helper-DlAUqK2U.js";const nt={class:"top-container"},it=["src"],ut={class:"cover",style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:ot,alt:""},dt={class:"info-container"},gt={class:"top-info"},yt={key:0,class:"game-info bg-box"},mt={key:1},vt={class:"song-info bg-box"},_t={key:2},pt={class:"process-box"},ht={class:"lyric-container"},ft={key:0,class:"lyric-box"},kt={class:"original"},bt={class:"translated"},Dt={key:1,class:"lyric-empty"},xt={__name:"Home4",setup(Ct){const t=Q(),f=R(JSON.parse(localStorage.getItem("extraInfo"))),L=S(localStorage.getItem("backgroundColor")||"rgba(0, 0, 0, 0.8)"),m=S(localStorage.getItem("textColor")||"rgba(255, 255, 255, 1)"),H=S(localStorage.getItem("shadowColor")||"rgba(255, 255, 255, 1)"),k=S([]),P=Z(()=>{var i,b;const l=((b=(i=t.songData)==null?void 0:i.player)==null?void 0:b.seekbarCurrentPositionHuman.split(":"))||0,c=parseInt(l[0])*60+parseInt(l[1]);let u=-1;for(let v=t.lyricData.lyric.length-1;v>=0;v--){const _=t.lyricData.lyric[v][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(_){const C=parseInt(_[1])*60+parseInt(_[2]);if(c>=C){u=v;break}}}let d=0;t.lyricData.translatedLyric.length===0?d=-(u-1)*67:d=-u*100;const g=document.querySelector(".lyric-box");return g&&(g.style.transform="translateY(".concat(d,"px)")),u}),K=()=>{var u,d;const l=new st,c=new Image;c.src=rt((d=(u=t.songData)==null?void 0:u.track)==null?void 0:d.cover),c.onload=function(){const g=l.getColor(c);L.value="rgba(".concat(g.join(","),", 1)"),m.value="rgba(".concat(g.map(i=>255-i).join(","),", 1)"),H.value="rgba(".concat(g.map(i=>255-i).join(","),", 1)"),k.value=l.getPalette(c).map(i=>"rgba(".concat(i.join(","),", 1)"))}};return JSON.parse(localStorage.getItem("isCustomColor"))||tt(()=>{var l,c;return(c=(l=t.songData)==null?void 0:l.track)==null?void 0:c.cover},(l,c)=>{l&&l!==c&&K()}),at(()=>{t.resetSongData()}),(l,c)=>(r(),I(a(lt),{width:1280,height:480,"box-style":{backgroundColor:"none"}},{default:p(()=>{var u,d,g,i,b,v,_,C,$,z,V,q,O,J,A,E,F,M;return[s("div",{class:"main",style:U({"--theme-color":L.value,"--text-color":m.value,"--bg-color":k.value[2]||m.value,"--shadow-color":H.value,"--stress-color":k.value[3]})},[s("div",nt,[W(X(et,{name:"fade",mode:"out-in"},{default:p(()=>{var o,e,D,x;return[(r(),n("img",{id:"cover",class:"cover",key:(e=(o=a(t).songData)==null?void 0:o.track)==null?void 0:e.cover,src:(x=(D=a(t).songData)==null?void 0:D.track)==null?void 0:x.cover,alt:"封面"},null,8,it))]}),_:1},512),[[Y,(d=(u=a(t).songData)==null?void 0:u.track)==null?void 0:d.cover]]),W(s("img",ut,null,512),[[Y,!((i=(g=a(t).songData)==null?void 0:g.track)!=null&&i.cover)]]),s("div",dt,[s("div",gt,[f.some(o=>o.length>0)?(r(),n("div",yt,[f[0].length>0?(r(),I(w,{key:0,color:m.value,"content-align":"center"},{default:p(()=>[N(y(f[0][0]),1)]),_:1},8,["color"])):h("",!0),f[1].length>0?(r(),n("div",mt,[X(w,{color:m.value,"content-align":"space-evenly"},{default:p(()=>[(r(!0),n(j,null,B(f[1].join(" | ").split(" "),(o,e)=>(r(),n("span",{key:e},y(o),1))),128))]),_:1},8,["color"])])):h("",!0)])):h("",!0),s("div",vt,[(v=(b=a(t).songData)==null?void 0:b.track)!=null&&v.title?(r(),I(w,{key:0,color:m.value,"is-bold":"bold"},{default:p(()=>{var o,e;return[N(y((e=(o=a(t).songData)==null?void 0:o.track)==null?void 0:e.title),1)]}),_:1},8,["color"])):h("",!0),(C=(_=a(t).songData)==null?void 0:_.track)!=null&&C.author?(r(),I(w,{key:1,color:m.value,"font-size":"35px"},{default:p(()=>{var o,e;return[N(y((e=(o=a(t).songData)==null?void 0:o.track)==null?void 0:e.author),1)]}),_:1},8,["color"])):h("",!0),!((z=($=a(t).songData)==null?void 0:$.track)!=null&&z.title)&&!((q=(V=a(t).songData)==null?void 0:V.track)!=null&&q.author)?(r(),n("span",_t,"暂无歌曲信息")):h("",!0)])]),s("div",pt,[s("span",null,y((J=(O=a(t).songData)==null?void 0:O.player)==null?void 0:J.seekbarCurrentPositionHuman),1),s("div",{class:"process-bar",style:U({"--bg-color":k.value[2]||L.value,"--stress-color":k.value[3]||m.value,"--process":((E=(A=a(t).songData)==null?void 0:A.player)==null?void 0:E.statePercent)||0})},null,4),s("span",null,y((M=(F=a(t).songData)==null?void 0:F.track)==null?void 0:M.durationHuman),1)])])]),s("div",ht,[a(t).lyricData.lyric.length>0?(r(),n("div",ft,[a(t).lyricData.translatedLyric.length===0?(r(!0),n(j,{key:0},B(a(t).lyricData.lyric,(o,e)=>(r(),n("div",{class:G(["lyric-line",{active:e===P.value}]),key:e},[s("span",null,y(o[2]),1)],2))),128)):(r(!0),n(j,{key:1},B(a(t).lyricData.lyric,(o,e)=>{var D,x;return r(),n("div",{class:G(["lyric-line-translated",{active:e===P.value}]),key:e},[s("span",kt,y((D=a(t).lyricData.translatedLyric.find(T=>T[1]===a(t).lyricData.lyric[e][1]))!=null&&D[2]?o[2]:""),1),s("span",bt,y(((x=a(t).lyricData.translatedLyric.find(T=>T[1]===a(t).lyricData.lyric[e][1]))==null?void 0:x[2])||o[2]),1)],2)}),128))])):(r(),n("div",Dt,"暂无歌词"))])],4)]}),_:1}))}},jt=ct(xt,[["__scopeId","data-v-7b2c8e82"]]);export{jt as default};
