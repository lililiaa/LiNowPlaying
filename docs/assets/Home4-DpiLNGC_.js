import{b2 as z,aC as B,B as x,v as q,D as C,C as V,a0 as h,a1 as p,u as a,U as s,Y as r,a8 as N,ad as P,Z as f,au as H,T as c,W as g,aQ as S,a7 as l,ah as E,X as I,a$ as T}from"./index-RcJPLJC9.js";import{_ as Y,a as F}from"./_plugin-vue_export-helper-DwRewS5w.js";import{u as J}from"./color-thief-DF3QbzqH.js";import{T as M,o as k}from"./v-scale-screen-BObGxHaO.js";const O={class:"top-container"},Q=["src"],U={class:"info-container"},W={class:"top-info"},X={key:0,class:"game-info bg-box"},Z={key:1},A={class:"song-info bg-box"},G={key:2},K={class:"process-box"},R={class:"lyric-container"},tt={key:0,class:"lyric-box"},at={class:"original"},et={class:"translated"},ot={key:1,class:"lyric-empty"},st={__name:"Home4",setup(rt){const t=z(),y=B(JSON.parse(localStorage.getItem("extraInfo"))),L=x("rgba(0, 0, 0, 0.8)"),d=x("rgba(255, 255, 255, 1)"),m=x([]),w=q(()=>{const n=t.songData?.player?.seekbarCurrentPositionHuman.split(":")||0,i=parseInt(n[0])*60+parseInt(n[1]);let o=-1;for(let _=t.lyricData.lyric.length-1;_>=0;_--){const b=t.lyricData.lyric[_][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(b){const j=parseInt(b[1])*60+parseInt(b[2]);if(i>=j){o=_;break}}}let e=0;t.lyricData.translatedLyric.length===0?e=-(o-1)*67:e=-o*100;const v=document.querySelector(".lyric-box");return v&&(v.style.transform=`translateY(${e}px)`),o}),$=()=>{const n=new J,i=document.getElementsByClassName("cover")[0];i.onload=function(){const o=n.getColor(i);L.value=`rgba(${o.join(",")}, 1)`,d.value=`rgba(${o.map(e=>255-e).join(",")}, 1)`,m.value=n.getPalette(i).map(e=>`rgba(${e.join(",")}, 1)`)}};C(()=>t.songData?.track?.cover,(n,i)=>{n&&n!==i&&$()});const u=B({status:"已暂停",name:"暂无歌曲"}),D=()=>{u.status&&u.name?document.title=u.status+" - "+u.name:document.title="歌曲组件"};return C(()=>t.songData?.player?.isPaused,n=>{n?u.status="已暂停":u.status="播放中",D()}),C(()=>t.songData?.track?.title,n=>{u.name=n,D()}),V(()=>{D(),t.resetSongData()}),(n,i)=>(s(),h(a(M),{width:"1280",height:"480","box-style":{backgroundColor:n.none}},{default:p(()=>[r("div",{class:"main",style:N({"--theme-color":L.value,"--text-color":d.value,"--bg-color":m.value[2],"--stress-color":m.value[3]})},[r("div",O,[P(r("img",{id:"cover",class:f(["cover",{changing:a(t).isChanging}]),crossorigin:"anonymous",src:a(t).songData?.track?.cover?a(t).songData?.track?.cover.replace("https://y.qq.com","/image"):"",alt:"封面"},null,10,Q),[[H,a(t).songData?.track?.cover]]),P(r("img",{class:f(["cover",{changing:a(t).isChanging}]),style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:F,alt:""},null,2),[[H,!a(t).songData?.track?.cover]]),r("div",U,[r("div",W,[y.some(o=>o.length>0)?(s(),c("div",X,[y[0].length>0?(s(),h(k,{key:0,color:d.value,"content-align":"center"},{default:p(()=>[S(l(y[0][0]),1)]),_:1},8,["color"])):g("",!0),y[1].length>0?(s(),c("div",Z,[E(k,{color:d.value,"content-align":"space-evenly"},{default:p(()=>[(s(!0),c(I,null,T(y[1].join(" | ").split(" "),(o,e)=>(s(),c("span",{key:e},l(o),1))),128))]),_:1},8,["color"])])):g("",!0)])):g("",!0),r("div",A,[a(t).songData?.track?.title?(s(),h(k,{key:0,color:d.value,"is-bold":"bold"},{default:p(()=>[S(l(a(t).songData?.track?.title),1)]),_:1},8,["color"])):g("",!0),a(t).songData?.track?.author?(s(),h(k,{key:1,color:d.value,"font-size":"35px"},{default:p(()=>[S(l(a(t).songData?.track?.author),1)]),_:1},8,["color"])):g("",!0),!a(t).songData?.track?.title&&!a(t).songData?.track?.author?(s(),c("span",G,"暂无歌曲信息")):g("",!0)])]),r("div",K,[r("span",null,l(a(t).songData?.player?.seekbarCurrentPositionHuman),1),r("div",{class:"process-bar",style:N({"--bg-color":m.value[2],"--stress-color":m.value[3],"--process":a(t).songData?.player?.statePercent||0})},null,4),r("span",null,l(a(t).songData?.track?.durationHuman),1)])])]),r("div",R,[a(t).lyricData.lyric.length>0?(s(),c("div",tt,[a(t).lyricData.translatedLyric.length===0?(s(!0),c(I,{key:0},T(a(t).lyricData.lyric,(o,e)=>(s(),c("div",{class:f(["lyric-line",{active:e===w.value}]),key:e},[r("span",null,l(o[2]),1)],2))),128)):(s(!0),c(I,{key:1},T(a(t).lyricData.lyric,(o,e)=>(s(),c("div",{class:f(["lyric-line-translated",{active:e===w.value}]),key:e},[r("span",at,l(o[2]),1),r("span",et,l(a(t).lyricData.translatedLyric.find(v=>v[1]===a(t).lyricData.lyric[e][1])?.[2]||""),1)],2))),128))])):(s(),c("div",ot,"暂无歌词"))])],4)]),_:1},8,["box-style"]))}},ut=Y(st,[["__scopeId","data-v-8f037910"]]);export{ut as default};
