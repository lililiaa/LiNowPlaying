import{c3 as et,aK as R,a1 as C,X as ot,a3 as N,a2 as st,as as S,at as b,L as a,am as r,ap as l,aA as W,aE as Z,aq as I,aF as tt,al as i,an as h,bb as P,az as m,aH as rt,ao as j,bd as z}from"./index-EYVoQ1Fb.js";import{_ as lt}from"./music-Def25HgW.js";import{g as ct,u as nt}from"./cover-DzIuO3oK.js";import{T as it,o as w}from"./v-scale-screen-pqug9WN0.js";import{_ as ut}from"./plugin-vueexport-helper-DlAUqK2U.js";const gt={class:"top-container"},dt=["src"],mt={class:"info-container"},yt={class:"top-info"},vt={key:0,class:"game-info bg-box"},pt={key:1},_t={class:"song-info bg-box"},ht={key:2},ft={class:"process-box"},kt={class:"lyric-container"},Dt={key:0,class:"lyric-box"},bt={class:"original"},xt={class:"translated"},Ct={key:1,class:"lyric-empty"},St={__name:"Home4",setup(It){const t=et(),f=R(JSON.parse(localStorage.getItem("extraInfo"))),L=C(localStorage.getItem("backgroundColor")||"rgba(0, 0, 0, 0.8)"),y=C(localStorage.getItem("textColor")||"rgba(255, 255, 255, 1)"),$=C(localStorage.getItem("shadowColor")||"rgba(255, 255, 255, 1)"),k=C([]),B=ot(()=>{var n,D;const e=((D=(n=t.songData)==null?void 0:n.player)==null?void 0:D.seekbarCurrentPositionHuman.split(":"))||0,o=parseInt(e[0])*60+parseInt(e[1]);let u=-1;for(let p=t.lyricData.lyric.length-1;p>=0;p--){const _=t.lyricData.lyric[p][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(_){const x=parseInt(_[1])*60+parseInt(_[2]);if(o>=x){u=p;break}}}let g=0;t.lyricData.translatedLyric.length===0?g=-(u-1)*67:g=-u*100;const d=document.querySelector(".lyric-box");return d&&(d.style.transform="translateY(".concat(g,"px)")),u}),at=()=>{var u,g;const e=new nt,o=new Image;o.src=ct((g=(u=t.songData)==null?void 0:u.track)==null?void 0:g.cover),o.onload=function(){const d=e.getColor(o);L.value="rgba(".concat(d.join(","),", 1)"),y.value="rgba(".concat(d.map(n=>255-n).join(","),", 1)"),$.value="rgba(".concat(d.map(n=>255-n).join(","),", 1)"),k.value=e.getPalette(o).map(n=>"rgba(".concat(n.join(","),", 1)"))}};JSON.parse(localStorage.getItem("isCustomColor"))||N(()=>{var e,o;return(o=(e=t.songData)==null?void 0:e.track)==null?void 0:o.cover},(e,o)=>{e&&e!==o&&at()});const v=R({status:"已暂停",name:"暂无歌曲"}),T=()=>{v.status&&v.name?document.title=v.status+" - "+v.name:document.title="歌曲组件"};return N(()=>{var e,o;return(o=(e=t.songData)==null?void 0:e.player)==null?void 0:o.isPaused},e=>{e?v.status="已暂停":v.status="播放中",T()}),N(()=>{var e,o;return(o=(e=t.songData)==null?void 0:e.track)==null?void 0:o.title},e=>{v.name=e,T()}),st(()=>{T(),t.resetSongData()}),(e,o)=>(r(),S(a(it),{width:1280,height:480,"box-style":{backgroundColor:"none"}},{default:b(()=>{var u,g,d,n,D,p,_,x,V,q,E,F,J,O,A,K,M,U,X,Y;return[l("div",{class:"main",style:W({"--theme-color":L.value,"--text-color":y.value,"--bg-color":k.value[2]||y.value,"--shadow-color":$.value,"--stress-color":k.value[3]})},[l("div",gt,[Z(l("img",{id:"cover",class:I(["cover",{changing:a(t).isChanging}]),src:(g=(u=a(t).songData)==null?void 0:u.track)==null?void 0:g.cover,alt:"封面"},null,10,dt),[[tt,(n=(d=a(t).songData)==null?void 0:d.track)==null?void 0:n.cover]]),Z(l("img",{class:I(["cover",{changing:a(t).isChanging}]),style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:lt,alt:""},null,2),[[tt,!((p=(D=a(t).songData)==null?void 0:D.track)!=null&&p.cover)]]),l("div",mt,[l("div",yt,[f.some(c=>c.length>0)?(r(),i("div",vt,[f[0].length>0?(r(),S(w,{key:0,color:y.value,"content-align":"center"},{default:b(()=>[P(m(f[0][0]),1)]),_:1},8,["color"])):h("",!0),f[1].length>0?(r(),i("div",pt,[rt(w,{color:y.value,"content-align":"space-evenly"},{default:b(()=>[(r(!0),i(j,null,z(f[1].join(" | ").split(" "),(c,s)=>(r(),i("span",{key:s},m(c),1))),128))]),_:1},8,["color"])])):h("",!0)])):h("",!0),l("div",_t,[(x=(_=a(t).songData)==null?void 0:_.track)!=null&&x.title?(r(),S(w,{key:0,color:y.value,"is-bold":"bold"},{default:b(()=>{var c,s;return[P(m((s=(c=a(t).songData)==null?void 0:c.track)==null?void 0:s.title),1)]}),_:1},8,["color"])):h("",!0),(q=(V=a(t).songData)==null?void 0:V.track)!=null&&q.author?(r(),S(w,{key:1,color:y.value,"font-size":"35px"},{default:b(()=>{var c,s;return[P(m((s=(c=a(t).songData)==null?void 0:c.track)==null?void 0:s.author),1)]}),_:1},8,["color"])):h("",!0),!((F=(E=a(t).songData)==null?void 0:E.track)!=null&&F.title)&&!((O=(J=a(t).songData)==null?void 0:J.track)!=null&&O.author)?(r(),i("span",ht,"暂无歌曲信息")):h("",!0)])]),l("div",ft,[l("span",null,m((K=(A=a(t).songData)==null?void 0:A.player)==null?void 0:K.seekbarCurrentPositionHuman),1),l("div",{class:"process-bar",style:W({"--bg-color":k.value[2]||L.value,"--stress-color":k.value[3]||y.value,"--process":((U=(M=a(t).songData)==null?void 0:M.player)==null?void 0:U.statePercent)||0})},null,4),l("span",null,m((Y=(X=a(t).songData)==null?void 0:X.track)==null?void 0:Y.durationHuman),1)])])]),l("div",kt,[a(t).lyricData.lyric.length>0?(r(),i("div",Dt,[a(t).lyricData.translatedLyric.length===0?(r(!0),i(j,{key:0},z(a(t).lyricData.lyric,(c,s)=>(r(),i("div",{class:I(["lyric-line",{active:s===B.value}]),key:s},[l("span",null,m(c[2]),1)],2))),128)):(r(!0),i(j,{key:1},z(a(t).lyricData.lyric,(c,s)=>{var G,Q;return r(),i("div",{class:I(["lyric-line-translated",{active:s===B.value}]),key:s},[l("span",bt,m((G=a(t).lyricData.translatedLyric.find(H=>H[1]===a(t).lyricData.lyric[s][1]))!=null&&G[2]?c[2]:""),1),l("span",xt,m(((Q=a(t).lyricData.translatedLyric.find(H=>H[1]===a(t).lyricData.lyric[s][1]))==null?void 0:Q[2])||c[2]),1)],2)}),128))])):(r(),i("div",Ct,"暂无歌词"))])],4)]}),_:1}))}},Pt=ut(St,[["__scopeId","data-v-4c6a0612"]]);export{Pt as default};
