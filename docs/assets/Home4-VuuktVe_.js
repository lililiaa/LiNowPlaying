import{bS as R,av as Z,r as x,c as tt,w as at,o as et,N as C,B as b,u as a,s as o,v as r,x as Y,an as G,y as S,ap as K,p as i,q as _,X as N,V as y,A as ot,O as T,W as j}from"./index-DLkcM1tU.js";import{_ as rt}from"./music-Def25HgW.js";import{g as st,u as lt}from"./cover-DzIuO3oK.js";import{o as I}from"./overflowText--V61kkcr.js";import{T as ct}from"./v-scale-screen-b1uMIy6X.js";import{_ as nt}from"./plugin-vueexport-helper-DlAUqK2U.js";const it={class:"top-container"},gt=["src"],ut={class:"info-container"},dt={class:"top-info"},yt={key:0,class:"game-info bg-box"},mt={key:1},vt={class:"song-info bg-box"},pt={key:2},_t={class:"process-box"},ht={class:"lyric-container"},ft={key:0,class:"lyric-box"},kt={class:"original"},bt={class:"translated"},Dt={key:1,class:"lyric-empty"},xt={__name:"Home4",setup(Ct){const t=R(),h=Z(JSON.parse(localStorage.getItem("extraInfo"))),w=x(localStorage.getItem("backgroundColor")||"rgba(0, 0, 0, 0.8)"),m=x(localStorage.getItem("textColor")||"rgba(255, 255, 255, 1)"),B=x(localStorage.getItem("shadowColor")||"rgba(255, 255, 255, 1)"),f=x([]),H=tt(()=>{var n,k;const l=((k=(n=t.songData)==null?void 0:n.player)==null?void 0:k.seekbarCurrentPositionHuman.split(":"))||0,c=parseInt(l[0])*60+parseInt(l[1]);let g=-1;for(let v=t.lyricData.lyric.length-1;v>=0;v--){const p=t.lyricData.lyric[v][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(p){const D=parseInt(p[1])*60+parseInt(p[2]);if(c>=D){g=v;break}}}let u=0;t.lyricData.translatedLyric.length===0?u=-(g-1)*67:u=-g*100;const d=document.querySelector(".lyric-box");return d&&(d.style.transform="translateY(".concat(u,"px)")),g}),Q=()=>{var g,u;const l=new lt,c=new Image;c.src=st((u=(g=t.songData)==null?void 0:g.track)==null?void 0:u.cover),c.onload=function(){const d=l.getColor(c);w.value="rgba(".concat(d.join(","),", 1)"),m.value="rgba(".concat(d.map(n=>255-n).join(","),", 1)"),B.value="rgba(".concat(d.map(n=>255-n).join(","),", 1)"),f.value=l.getPalette(c).map(n=>"rgba(".concat(n.join(","),", 1)"))}};return JSON.parse(localStorage.getItem("isCustomColor"))||at(()=>{var l,c;return(c=(l=t.songData)==null?void 0:l.track)==null?void 0:c.cover},(l,c)=>{l&&l!==c&&Q()}),et(()=>{t.resetSongData()}),(l,c)=>(o(),C(a(ct),{width:1280,height:480,"box-style":{backgroundColor:"none"}},{default:b(()=>{var g,u,d,n,k,v,p,D,P,$,z,V,O,q,J,A,E,F,M,U;return[r("div",{class:"main",style:Y({"--theme-color":w.value,"--text-color":m.value,"--bg-color":f.value[2]||m.value,"--shadow-color":B.value,"--stress-color":f.value[3]})},[r("div",it,[G(r("img",{id:"cover",class:S(["cover",{changing:a(t).isChanging}]),src:(u=(g=a(t).songData)==null?void 0:g.track)==null?void 0:u.cover,alt:"封面"},null,10,gt),[[K,(n=(d=a(t).songData)==null?void 0:d.track)==null?void 0:n.cover]]),G(r("img",{class:S(["cover",{changing:a(t).isChanging}]),style:{"box-sizing":"border-box",padding:"30px",color:"#fff"},src:rt,alt:""},null,2),[[K,!((v=(k=a(t).songData)==null?void 0:k.track)!=null&&v.cover)]]),r("div",ut,[r("div",dt,[h.some(s=>s.length>0)?(o(),i("div",yt,[h[0].length>0?(o(),C(I,{key:0,color:m.value,"content-align":"center"},{default:b(()=>[N(y(h[0][0]),1)]),_:1},8,["color"])):_("",!0),h[1].length>0?(o(),i("div",mt,[ot(I,{color:m.value,"content-align":"space-evenly"},{default:b(()=>[(o(!0),i(T,null,j(h[1].join(" | ").split(" "),(s,e)=>(o(),i("span",{key:e},y(s),1))),128))]),_:1},8,["color"])])):_("",!0)])):_("",!0),r("div",vt,[(D=(p=a(t).songData)==null?void 0:p.track)!=null&&D.title?(o(),C(I,{key:0,color:m.value,"is-bold":"bold"},{default:b(()=>{var s,e;return[N(y((e=(s=a(t).songData)==null?void 0:s.track)==null?void 0:e.title),1)]}),_:1},8,["color"])):_("",!0),($=(P=a(t).songData)==null?void 0:P.track)!=null&&$.author?(o(),C(I,{key:1,color:m.value,"font-size":"35px"},{default:b(()=>{var s,e;return[N(y((e=(s=a(t).songData)==null?void 0:s.track)==null?void 0:e.author),1)]}),_:1},8,["color"])):_("",!0),!((V=(z=a(t).songData)==null?void 0:z.track)!=null&&V.title)&&!((q=(O=a(t).songData)==null?void 0:O.track)!=null&&q.author)?(o(),i("span",pt,"暂无歌曲信息")):_("",!0)])]),r("div",_t,[r("span",null,y((A=(J=a(t).songData)==null?void 0:J.player)==null?void 0:A.seekbarCurrentPositionHuman),1),r("div",{class:"process-bar",style:Y({"--bg-color":f.value[2]||w.value,"--stress-color":f.value[3]||m.value,"--process":((F=(E=a(t).songData)==null?void 0:E.player)==null?void 0:F.statePercent)||0})},null,4),r("span",null,y((U=(M=a(t).songData)==null?void 0:M.track)==null?void 0:U.durationHuman),1)])])]),r("div",ht,[a(t).lyricData.lyric.length>0?(o(),i("div",ft,[a(t).lyricData.translatedLyric.length===0?(o(!0),i(T,{key:0},j(a(t).lyricData.lyric,(s,e)=>(o(),i("div",{class:S(["lyric-line",{active:e===H.value}]),key:e},[r("span",null,y(s[2]),1)],2))),128)):(o(!0),i(T,{key:1},j(a(t).lyricData.lyric,(s,e)=>{var W,X;return o(),i("div",{class:S(["lyric-line-translated",{active:e===H.value}]),key:e},[r("span",kt,y((W=a(t).lyricData.translatedLyric.find(L=>L[1]===a(t).lyricData.lyric[e][1]))!=null&&W[2]?s[2]:""),1),r("span",bt,y(((X=a(t).lyricData.translatedLyric.find(L=>L[1]===a(t).lyricData.lyric[e][1]))==null?void 0:X[2])||s[2]),1)],2)}),128))])):(o(),i("div",Dt,"暂无歌词"))])],4)]}),_:1}))}},jt=nt(xt,[["__scopeId","data-v-cc57bedb"]]);export{jt as default};
