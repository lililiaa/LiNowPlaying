import{c2 as R,a1 as r,aK as D,a3 as y,a2 as E,a5 as F,as as W,at as S,L as M,am as b,ap as s,aA as B,aE as L,aF as T,aH as z,aG as A,al as P}from"./index-D_YEYRn5.js";import{T as q}from"./v-scale-screen-QmHYQi8k.js";import{_ as N}from"./plugin-vueexport-helper-DlAUqK2U.js";const G={class:"surface-container"},V={class:"rain-container"},X={class:"street-light"},Y={class:"top"},J={__name:"Home7",setup(K){const c=R(),w=r(localStorage.getItem("backgroundColor")||"rgba(0, 0, 0, 0.8)"),C=r(localStorage.getItem("textColor")||"rgba(255, 255, 255, 1)"),k=r(localStorage.getItem("shadowColor")||"rgba(255, 255, 255, 1)"),x=r([]);class H{constructor(t,a){this.canvasWidth=t,this.canvasHeight=a,this.reset()}reset(){this.y=Math.random()*-this.canvasHeight,i.value.angle>=0?this.x=(Math.random()*1.3-.3)*this.canvasWidth:this.x=Math.random()*1.3*this.canvasWidth,this.length=Math.random()*20+20,this.width=Math.random()*1+2,this.speedFactor=Math.random()*.5+.7}update(t,a){const o=t*Math.PI/180,u=Math.sin(o)*a,g=Math.cos(o)*a*this.speedFactor;this.x+=u,this.y+=g,this.y>this.canvasHeight&&this.reset()}draw(t,a){const o=a*Math.PI/180,u=this.x-Math.sin(o)*this.length,g=this.y-Math.cos(o)*this.length,p=t.createLinearGradient(this.x,this.y,u,g);p.addColorStop(0,w.value),p.addColorStop(1,"rgba(255, 255, 255, 0)"),t.beginPath(),t.moveTo(this.x,this.y),t.lineTo(u,g),t.strokeStyle=p,t.lineWidth=this.width,t.stroke()}}const l=r(null);let m=null,h=[],d=null;const i=r(JSON.parse(localStorage.getItem("rainConfig")||{isRain:!0,amount:100,angle:10,speed:5})),n=D({status:"已暂停",name:"暂无歌曲"}),v=()=>{n.status&&n.name?document.title=n.status+" - "+n.name:document.title="歌曲组件"};y(()=>{var e,t;return(t=(e=c.songData)==null?void 0:e.player)==null?void 0:t.isPaused},e=>{e?n.status="已暂停":n.status="播放中",v()}),y(()=>{var e,t;return(t=(e=c.songData)==null?void 0:e.track)==null?void 0:t.title},e=>{n.name=e,v()}),E(()=>{v(),c.resetSongData();const e=l.value;m=e.getContext("2d"),f(e),I(e),d=requestAnimationFrame(_),window.addEventListener("resize",()=>f(l.value))}),F(()=>{d&&cancelAnimationFrame(d),window.removeEventListener("resize",()=>f(l.value))});function f(e){let t=document.querySelector(".rain-container");e.width=t.clientWidth,e.height=t.clientHeight,h.forEach(a=>{a.canvasWidth=e.width,a.canvasHeight=e.height})}function I(e){h=[];for(let t=0;t<i.value.amount;t++)h.push(new H(e.width,e.height));console.log(h.length)}function _(){const e=l.value;m.clearRect(0,0,e.width,e.height),h.forEach(t=>{t.update(i.value.angle,i.value.speed),t.draw(m,i.value.angle)}),d=requestAnimationFrame(_)}return(e,t)=>(b(),W(M(q),{width:1900,height:1200,"box-style":{backgroundColor:"none"}},{default:S(()=>[s("div",{class:"main",style:B({"--theme-color":w.value,"--text-color":C.value,"--bg-color":x.value[2]||C.value,"--shadow-color":k.value})},[s("div",G,[s("div",V,[L(s("canvas",{id:"rainCanvas",ref_key:"rainCanvas",ref:l},null,512),[[T,i.value.isRain]])]),s("div",X,[t[0]||(t[0]=s("svg",{width:"120",height:"60",viewBox:"0 0 120 60",class:"shade"},[s("polygon",{points:"60,10 0,55 120,55"})],-1)),s("div",Y,[z(A,{name:"fade"},{default:S(()=>{var a,o;return[(b(),P("div",{class:"light",key:(o=(a=M(c).songData)==null?void 0:a.track)==null?void 0:o.cover}))]}),_:1})]),t[1]||(t[1]=s("div",{class:"center"},null,-1)),t[2]||(t[2]=s("div",{class:"bottom"},null,-1))])]),t[3]||(t[3]=s("div",{class:"curb-container"},null,-1))],4)]),_:1}))}},Q=N(J,[["__scopeId","data-v-e572fc6e"]]);export{Q as default};
