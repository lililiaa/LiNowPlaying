import{bS as w,c as L,r as m,w as B,o as T,N as $,B as j,u as c,a2 as N,cl as q,s as n,v as g,x as z,p as y,O as h,W as C,y as D,V as p}from"./index-rwlLbiDS.js";import{T as A}from"./v-scale-screen-lCa8Oxx2.js";import{g as O,u as P}from"./cover-DzIuO3oK.js";import{_ as V}from"./plugin-vueexport-helper-DlAUqK2U.js";const E={class:"lyric-container"},F={key:0,class:"lyric-box"},H={class:"original"},J={class:"translated"},M={key:1,class:"lyric-empty"},R={__name:"lyric",setup(U){q(t=>({"95d3f524":u.value}));const e=w(),v=L(()=>{var l,i;const t=((i=(l=e.songData)==null?void 0:l.player)==null?void 0:i.seekbarCurrentPositionHuman.split(":"))||0,a=parseInt(t[0])*60+parseInt(t[1]);let o=-1;for(let d=e.lyricData.lyric.length-1;d>=0;d--){const f=e.lyricData.lyric[d][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(f){const I=parseInt(f[1])*60+parseInt(f[2]);if(a>=I){o=d;break}}}let r=0;e.lyricData.translatedLyric.length===0?r=-(o-4)*100:r=-(o-2)*160;const s=document.querySelector(".lyric-box");return s&&(s.style.transform="translateY(".concat(r,"px)")),o}),b=m(localStorage.getItem("backgroundColor")||"rgba(0, 0, 0, 0.8)"),_=m(localStorage.getItem("textColor")||"rgba(255, 255, 255, 1)"),k=m(localStorage.getItem("shadowColor")||"rgba(255, 255, 255, 1)"),S=()=>{var o,r;const t=new P,a=new Image;a.src=O((r=(o=e.songData)==null?void 0:o.track)==null?void 0:r.cover),a.onload=function(){const s=t.getColor(a);b.value="rgba(".concat(s.join(","),", 1)"),_.value="rgba(".concat(s.map(l=>255-l).join(","),", 1)"),k.value="rgba(".concat(s.map(l=>255-l).join(","),", 1)")}};JSON.parse(localStorage.getItem("isCustomColor"))||B(()=>{var t,a;return(a=(t=e.songData)==null?void 0:t.track)==null?void 0:a.cover},(t,a)=>{t&&t!==a&&S()});const u=m("center"),x=()=>{var a;let t=(a=N.currentRoute.value.query)==null?void 0:a.align;t==="left"?u.value="left":t==="center"?u.value="center":t==="right"?u.value="right":u.value="center"};return T(()=>{x(),e.resetSongData()}),(t,a)=>(n(),$(c(A),{"box-style":{backgroundColor:"none"}},{default:j(()=>[g("div",{class:"main",style:z({"--text-color":_.value})},[g("div",E,[c(e).lyricData.lyric.length>0?(n(),y("div",F,[c(e).lyricData.translatedLyric.length===0?(n(!0),y(h,{key:0},C(c(e).lyricData.lyric,(o,r)=>(n(),y("div",{class:D(["lyric-line",{active:r===v.value}]),key:r},[g("span",null,p(o[2]),1)],2))),128)):(n(!0),y(h,{key:1},C(c(e).lyricData.lyric,(o,r)=>{var s,l;return n(),y("div",{class:D(["lyric-line-translated",{active:r===v.value}]),key:r},[g("span",H,p((s=c(e).lyricData.translatedLyric.find(i=>i[1]===c(e).lyricData.lyric[r][1]))!=null&&s[2]?o[2]:""),1),g("span",J,p(((l=c(e).lyricData.translatedLyric.find(i=>i[1]===c(e).lyricData.lyric[r][1]))==null?void 0:l[2])||o[2]),1)],2)}),128))])):(n(),y("div",M,"暂无歌词"))])],4)]),_:1}))}},Q=V(R,[["__scopeId","data-v-3c25b33c"]]);export{Q as default};
