!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,a(i.key),i)}}function a(e){var a=function(e,a){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,a||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(e,"string");return"symbol"==t(a)?a:a+""}System.register(["./index-legacy-oa_uyP2R.js","./overflowText-legacy-DhTnJhVJ.js","./v-scale-screen-legacy-BMWQeUeJ.js","./cover-legacy-BlVuG08V.js","./plugin-vueexport-helper-legacy-DCWa1RRI.js"],function(t,a){"use strict";var n,i,r,o,l,c,s,d,u,v,h,p,f,g,m,y,x,b,w,k,D,S,z,j,C,_,I,M;return{setters:[function(t){n=t.bS,i=t.r,r=t.w,o=t.c,l=t.av,c=t.o,s=t.cp,d=t.N,u=t.B,v=t.u,h=t.cl,p=t.s,f=t.v,g=t.x,m=t.an,y=t.A,x=t.ap,b=t.aq,w=t.p,k=t.q,D=t.X,S=t.V,z=t.O},function(t){j=t.o},function(t){C=t.T},function(t){_=t.g,I=t.u},function(t){M=t._}],execute:function(){var a=document.createElement("style");a.textContent=".lyric-enter-active[data-v-12973e57],.lyric-leave-active[data-v-12973e57]{transition:all .3s cubic-bezier(.4,0,.2,1)}.lyric-enter-from[data-v-12973e57]{opacity:0;transform:translateY(20px)}.lyric-leave-to[data-v-12973e57]{opacity:0;transform:translateY(-10px)}.main[data-v-12973e57]{width:1700px;height:600px;margin:100px;display:flex;flex-direction:column;justify-content:center;font-family:hyp,Trebuchet MS,Lucida Sans Unicode,Lucida Grande,Lucida Sans,Arial,sans-serif}.main .surface-container[data-v-12973e57]{position:relative;flex:1}.main .surface-container .rain-container[data-v-12973e57]{display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;position:relative;width:100%;height:100%;overflow:hidden;-webkit-mask-image:linear-gradient(to bottom,transparent,#000 50px),linear-gradient(to right,transparent,#000 100px,#000 calc(100% - 100px),transparent);mask-image:linear-gradient(to bottom,transparent,#000 50px),linear-gradient(to right,transparent,#000 100px,#000 calc(100% - 100px),transparent);-webkit-mask-composite:source-in;mask-composite:intersect;z-index:2}.main .surface-container .rain-container canvas[data-v-12973e57]{position:absolute;top:0;left:0;z-index:5}.main .surface-container .rain-container .song-container[data-v-12973e57]{margin-right:100px;width:1300px;overflow:hidden;font-size:50px;display:flex;align-items:flex-end;padding-bottom:10px;z-index:3;color:var(--text-color);font-size:var(--072ebbb2)}.main .surface-container .rain-container .song-container .separate[data-v-12973e57]{margin:0 5px;transition:color 2s ease}.main .surface-container .rain-container .lyric-container[data-v-12973e57]{margin-right:100px;width:1300px;height:100px;box-sizing:border-box;overflow:hidden;z-index:3;display:flex;align-items:center;position:relative}.main .surface-container .rain-container .lyric-container span[data-v-12973e57]{color:var(--text-color);transition:color 2s ease;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.main .surface-container .rain-container .lyric-container .lyric-line[data-v-12973e57]{width:100%;font-size:var(--072ebbb2)}.main .surface-container .rain-container .lyric-container .lyric-line-translated[data-v-12973e57]{height:100%;width:100%;white-space:nowrap;position:relative}.main .surface-container .rain-container .lyric-container .lyric-line-translated span[data-v-12973e57]{max-width:100%;position:absolute}.main .surface-container .rain-container .lyric-container .lyric-line-translated .original[data-v-12973e57]{top:-10px;right:0;font-size:var(--f48be724);opacity:.8;filter:blur(2px)}.main .surface-container .rain-container .lyric-container .lyric-line-translated .translated[data-v-12973e57]{bottom:0;left:0;font-size:var(--26db04ee)}.main .surface-container .rain-container .lyric-container .lyric-empty[data-v-12973e57]{color:var(--text-color);font-size:var(--072ebbb2);font-weight:700;transition:all 2s ease-in-out}.main .surface-container .street-light[data-v-12973e57]{height:100%;width:300px;position:absolute;left:100px;top:0;display:flex;flex-direction:column;justify-content:flex-end;align-items:center}.main .surface-container .street-light div[data-v-12973e57]{box-sizing:border-box;transition:border-color 2s ease}.main .surface-container .street-light .shade polygon[data-v-12973e57]{fill:none;stroke:var(--theme-color);stroke-width:5px;stroke-dasharray:10 5}.main .surface-container .street-light .top[data-v-12973e57]{width:50px;height:50px;border:5px dashed var(--theme-color);border-top:none;position:relative}.main .surface-container .street-light .top .light[data-v-12973e57]{position:absolute;width:500px;height:400px;left:50%;top:-32px;transform:translate(-50%);background:radial-gradient(circle 150px at center 10px,var(--shadow-color) 30px,transparent);clip-path:polygon(190px 29px,310px 29px,100% 45%,100% 100%,0 100%,0 45%)}.main .surface-container .street-light .top .fade-enter-active[data-v-12973e57],.main .surface-container .street-light .top .fade-leave-active[data-v-12973e57]{transition:opacity 2s ease}.main .surface-container .street-light .top .fade-enter-from[data-v-12973e57],.main .surface-container .street-light .top .fade-leave-to[data-v-12973e57]{opacity:0}.main .surface-container .street-light .center[data-v-12973e57]{width:25px;height:250px;border:5px dashed var(--theme-color);border-top:none;border-bottom:none}.main .surface-container .street-light .bottom[data-v-12973e57]{width:35px;height:50px;border:5px dashed var(--theme-color);border-bottom:none}.main .curb-container[data-v-12973e57]{width:100%;height:80px;display:flex;justify-content:space-around;box-sizing:border-box;border-top:5px dashed var(--theme-color);-webkit-mask-image:linear-gradient(to right,transparent,#000 200px,#000 calc(100% - 200px),transparent);mask-image:linear-gradient(to right,transparent,#000 200px,#000 calc(100% - 200px),transparent);transition:border-color 2s ease;z-index:2}\n/*$vite$:1*/",document.head.appendChild(a);var L={class:"surface-container"},P={class:"rain-container"},T={key:1,class:"separate"},E={key:3},H={class:"original"},W={class:"translated"},q={key:1,class:"lyric-empty"},A={class:"street-light"},F={class:"top"},O="80px",R="50px";t("default",M({__name:"rain",setup:function(t){h(function(t){return{"072ebbb2":O,"26db04ee":"65px",f48be724:R}});var a=n(),M=i(localStorage.getItem("backgroundColor")||"rgba(0, 0, 0, 0.8)"),N=i(localStorage.getItem("textColor")||"rgba(255, 255, 255, 1)"),B=i(localStorage.getItem("shadowColor")||"rgba(255, 255, 255, 1)"),G=i([]),J=function(){return t=function t(e,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvasWidth=e,this.canvasHeight=a,this.reset()},a=[{key:"reset",value:function(){this.y=Math.random()*-this.canvasHeight,X.value.angle>=0?this.x=(1.2*Math.random()-.2)*this.canvasWidth:this.x=1.2*Math.random()*this.canvasWidth,this.length=10*Math.random()+30,this.width=1*Math.random()+3,this.speedFactor=.5*Math.random()+.7}},{key:"update",value:function(t,e){var a=t*Math.PI/180,n=Math.sin(a)*e,i=Math.cos(a)*e*this.speedFactor;this.x+=n,this.y+=i,this.y>this.canvasHeight+30&&this.reset()}},{key:"draw",value:function(t,e){var a=e*Math.PI/180,n=this.x-Math.sin(a)*this.length,i=this.y-Math.cos(a)*this.length,r=t.createLinearGradient(this.x,this.y,n,i);r.addColorStop(0,M.value),r.addColorStop(1,"rgba(255, 255, 255, 0)"),t.beginPath(),t.moveTo(this.x,this.y),t.lineTo(n,i),t.strokeStyle=r,t.lineWidth=this.width,t.stroke()}}],a&&e(t.prototype,a),n&&e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,a,n}(),Y=i(null),$=null,U=[],V=null,X=i(JSON.parse(localStorage.getItem("rainConfig")||{isRain:!0,amount:100,angle:0,speed:10}));JSON.parse(localStorage.getItem("isCustomColor"))||r(function(){var t;return null===(t=a.songData)||void 0===t||null===(t=t.track)||void 0===t?void 0:t.cover},function(t,e){var n,i,r;t&&t!==e&&(i=new I,(r=new Image).src=_(null===(n=a.songData)||void 0===n||null===(n=n.track)||void 0===n?void 0:n.cover),r.onload=function(){var t=i.getColor(r);M.value="rgba(".concat(t.join(","),", 1)"),N.value="rgba(".concat(t.map(function(t){return 255-t}).join(","),", 1)"),B.value="rgba(".concat(t.map(function(t){return 255-t}).join(","),", 1)"),G.value=i.getPalette(r).map(function(t){return"rgba(".concat(t.join(","),", 1)")})})});var K=o(function(){for(var t,e=(null===(t=a.songData)||void 0===t||null===(t=t.player)||void 0===t?void 0:t.seekbarCurrentPositionHuman.split(":"))||0,n=60*parseInt(e[0])+parseInt(e[1]),i=-1,r=a.lyricData.lyric.length-1;r>=0;r--){var o=a.lyricData.lyric[r][1].match(/\[(\d+):(\d+)\.(\d+)\]/);if(o)if(n>=60*parseInt(o[1])+parseInt(o[2])){i=r;break}}return i}),Q=i(""),Z=i(""),tt=i(null);function et(t){var e=document.querySelector(".rain-container");t.width=e.clientWidth,t.height=e.clientHeight,U.forEach(function(e){e.canvasWidth=t.width,e.canvasHeight=t.height})}function at(){var t=Y.value;$.clearRect(0,0,t.width,t.height),U.forEach(function(t){t.update(X.value.angle,X.value.speed),t.draw($,X.value.angle)}),V=requestAnimationFrame(at)}return r(K,function(t,e){if(a.lyricData.translatedLyric.length>0)if(-1===t)Q.value="",Z.value="";else{var n=a.lyricData.lyric[t][1],i=a.lyricData.translatedLyric.find(function(t){return t[1]===n});i&&i[2]?(Z.value=i[2],Q.value=a.lyricData.lyric[t][2]):(Z.value=a.lyricData.lyric[t][2],Q.value="")}}),l({status:"已暂停",name:"暂无歌曲"}),c(function(){a.resetSongData();var t=Y.value;$=t.getContext("2d"),et(t),function(t){U=[];for(var e=0;e<X.value.amount;e++)U.push(new J(t.width,t.height))}(t),V=requestAnimationFrame(at);var e=null;window.addEventListener("resize",function(){clearTimeout(e),e=setTimeout(function(){et(Y.value)},200)})}),s(function(){V&&cancelAnimationFrame(V),window.removeEventListener("resize",function(){return et(Y.value)})}),function(t,e){return p(),d(v(C),{width:1900,height:800,"box-style":{backgroundColor:"none"}},{default:u(function(){return[f("div",{class:"main",style:g({"--theme-color":M.value,"--text-color":N.value,"--bg-color":G.value[2]||N.value,"--shadow-color":B.value})},[f("div",L,[f("div",P,[m(f("canvas",{id:"rainCanvas",ref_key:"rainCanvas",ref:Y},null,512),[[x,X.value.isRain]]),y(b,{name:"lyric",mode:"out-in"},{default:u(function(){var t,e,n,i,r,o,l;return[(p(),w("div",{class:"song-container",key:null===(t=v(a).songData)||void 0===t||null===(t=t.track)||void 0===t?void 0:t.title},[null!==(e=v(a).songData)&&void 0!==e&&null!==(e=e.track)&&void 0!==e&&e.title?(p(),d(j,{key:0,color:N.value,"font-size":O,"is-bold":"bold"},{default:u(function(){var t;return[D(S(null===(t=v(a).songData)||void 0===t||null===(t=t.track)||void 0===t?void 0:t.title),1)]}),_:1},8,["color"])):k("",!0),null!==(n=v(a).songData)&&void 0!==n&&null!==(n=n.track)&&void 0!==n&&n.title&&null!==(i=v(a).songData)&&void 0!==i&&null!==(i=i.track)&&void 0!==i&&i.author?(p(),w("span",T,"-")):k("",!0),null!==(r=v(a).songData)&&void 0!==r&&null!==(r=r.track)&&void 0!==r&&r.author?(p(),d(j,{key:2,color:N.value,"font-size":R,"is-bold":"bold"},{default:u(function(){var t;return[D(S(null===(t=v(a).songData)||void 0===t||null===(t=t.track)||void 0===t?void 0:t.author),1)]}),_:1},8,["color"])):k("",!0),null!==(o=v(a).songData)&&void 0!==o&&null!==(o=o.track)&&void 0!==o&&o.title||null!==(l=v(a).songData)&&void 0!==l&&null!==(l=l.track)&&void 0!==l&&l.author?k("",!0):(p(),w("span",E,"暂无歌曲信息"))]))]}),_:1}),y(b,{name:"lyric",mode:"out-in"},{default:u(function(){var t;return[(p(),w("div",{class:"lyric-container",key:K.value},[v(a).lyricData.lyric.length>0?(p(),w(z,{key:0},[0===v(a).lyricData.translatedLyric.length?(p(),w("span",{key:0,ref_key:"lyricRef",ref:tt,class:"lyric-line"},S((null===(t=v(a).lyricData.lyric[K.value])||void 0===t?void 0:t.length)>0&&v(a).lyricData.lyric[K.value][2]||"......"),513)):(p(),w("div",{key:1,ref_key:"lyricRef",ref:tt,class:"lyric-line-translated"},[f("span",H,S(Q.value),1),f("span",W,S(Z.value),1)],512))],64)):(p(),w("span",q,"暂无歌词"))]))]}),_:1})]),f("div",A,[e[0]||(e[0]=f("svg",{width:"120",height:"60",viewBox:"0 0 120 60",class:"shade"},[f("polygon",{points:"60,10 0,55 120,55"})],-1)),f("div",F,[y(b,{name:"fade"},{default:u(function(){var t;return[(p(),w("div",{class:"light",key:null===(t=v(a).songData)||void 0===t||null===(t=t.track)||void 0===t?void 0:t.cover}))]}),_:1})]),e[1]||(e[1]=f("div",{class:"center"},null,-1)),e[2]||(e[2]=f("div",{class:"bottom"},null,-1))])]),e[3]||(e[3]=f("div",{class:"curb-container"},null,-1))],4)]}),_:1})}}},[["__scopeId","data-v-12973e57"]]))}}})}();
